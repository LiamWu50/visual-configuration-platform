{"version":3,"file":"index-DTwjaRXe.js","sources":["../../../src/views/design-space/chart/layers/index.tsx","../../../src/views/design-space/chart/layers/use-context-menu.ts"],"sourcesContent":["import imageSrc from '@/assets/images/editor/img.jpg'\nimport { Primitive } from '@/primitives/primitive'\nimport { useEditorStore } from '@/store/editor/index'\n\nimport styles from './index.module.scss'\nimport { useContextMenu } from './use-context-menu'\n\nexport default defineComponent({\n  name: 'Layers',\n  setup() {\n    const xRef = ref(0)\n    const yRef = ref(0)\n    const showDropdownRef = ref(false)\n    const selectedPrimitiveRef = ref<Primitive | null>(null)\n    const editorStore = useEditorStore()\n    const primitives = editorStore.primitives as Primitive[]\n    const { menuOptions, typeHandler, handleProcess } = useContextMenu()\n\n    const handleSelect = (key: string) => {\n      showDropdownRef.value = false\n      handleProcess(\n        selectedPrimitiveRef.value as Primitive,\n        key as keyof typeof typeHandler\n      )\n    }\n\n    const onClickoutside = () => {\n      showDropdownRef.value = false\n    }\n\n    const handleContextMenu = (e: MouseEvent, item: Primitive) => {\n      e.preventDefault()\n      selectedPrimitiveRef.value = item\n      showDropdownRef.value = false\n      nextTick().then(() => {\n        showDropdownRef.value = true\n        xRef.value = e.clientX\n        yRef.value = e.clientY\n      })\n    }\n\n    return {\n      xRef,\n      yRef,\n      showDropdownRef,\n      primitives,\n      menuOptions,\n      handleSelect,\n      onClickoutside,\n      handleContextMenu\n    }\n  },\n  render() {\n    const renderLayerItems = () =>\n      this.primitives.map((item: Primitive) => (\n        <div\n          class={styles.layerItem}\n          onContextmenu={(e) => this.handleContextMenu(e, item)}\n        >\n          <div class={styles.imgCover}>\n            <img src={imageSrc} />\n          </div>\n          {item.isReName ? (\n            <NInput\n              v-model:value={item.name}\n              autofocus={true}\n              onBlur={() => (item.isReName = false)}\n              onKeyup={(e) => e.key === 'Enter' && (item.isReName = false)}\n              type='text'\n              placeholder='请输入组件名称'\n            />\n          ) : (\n            <span>{item.name}</span>\n          )}\n        </div>\n      ))\n\n    return (\n      <div class={styles.layers}>\n        <div class={styles.container}>{renderLayerItems()}</div>\n        <NDropdown\n          placement='bottom-start'\n          trigger='manual'\n          x={this.xRef}\n          y={this.yRef}\n          options={this.menuOptions}\n          show={this.showDropdownRef}\n          onSelect={this.handleSelect}\n          onClickoutside={this.onClickoutside}\n        />\n      </div>\n    )\n  }\n})\n","import { Primitive } from '@/primitives/primitive'\n\nexport function useContextMenu() {\n  const menuOptions = [\n    {\n      label: '重命名',\n      key: 'reName'\n    },\n    {\n      label: '复制',\n      key: ' copy'\n    },\n    {\n      label: '粘贴',\n      key: 'paste'\n    },\n    {\n      label: '删除',\n      key: 'delete'\n    },\n    {\n      label: '锁定',\n      key: 'others1'\n    },\n    {\n      label: '清空剪贴板',\n      key: 'others1'\n    }\n  ]\n\n  const handleReName = (primitive: Primitive) => {\n    primitive.isReName = true\n  }\n\n  const typeHandler = {\n    reName: handleReName\n  }\n\n  const handleProcess = (\n    primitive: Primitive,\n    type: keyof typeof typeHandler\n  ) => {\n    typeHandler[type](primitive)\n  }\n\n  return {\n    menuOptions,\n    typeHandler,\n    handleProcess\n  }\n}\n"],"names":["defineComponent","name","setup","xRef","ref","yRef","showDropdownRef","selectedPrimitiveRef","primitives","useEditorStore","menuOptions","typeHandler","handleProcess","reName","primitive","isReName","label","key","type","useContextMenu","handleSelect","value","onClickoutside","handleContextMenu","e","item","preventDefault","nextTick","then","clientX","clientY","render","_createVNode","class","styles","renderLayerItems","this","map","onContextmenu","src","imageSrc","_resolveComponent","$event","autofocus","onBlur","onKeyup","placeholder","placement","trigger","x","y","options","show","onSelect"],"mappings":"g6BAOA,MAAeA,EAAgBA,EAAA,CAC7BC,KAAM,SACNC,KAAAA,GACQC,MAAAA,EAAOC,EAAI,GACXC,EAAOD,EAAI,GACXE,EAAkBF,GAAI,GACtBG,EAAuBH,EAAsB,MAE7CI,EADcC,IACWD,YACzBE,YAAEA,EAAAA,YAAaC,EAAAA,cAAaC,GCd/B,WACL,MA+BMD,EAAc,CAClBE,OALoBC,IACpBA,EAAUC,UAAW,CAAA,GAchB,MAAA,CACLL,YA3CkB,CAClB,CACEM,MAAO,MACPC,IAAK,UAEP,CACED,MAAO,KACPC,IAAK,SAEP,CACED,MAAO,KACPC,IAAK,SAEP,CACED,MAAO,KACPC,IAAK,UAEP,CACED,MAAO,KACPC,IAAK,WAEP,CACED,MAAO,QACPC,IAAK,YAqBPN,cACAC,cAVoB,CACpBE,EACAI,KAEYP,EAAAO,GAAMJ,EAAS,EAQ/B,CDlCwDK,GAyB7C,MAAA,CACLhB,OACAE,OACAC,kBACAE,aACAE,cACAU,aA7BoCH,IACpCX,EAAgBe,OAAQ,EAEtBd,EAAAA,EAAqBc,MACrBJ,EACF,EAyBAK,eAtBqBA,KACrBhB,EAAgBe,OAAQ,CAAA,EAsBxBE,kBAnBwBA,CAACC,EAAeC,KACxCD,EAAEE,iBACFnB,EAAqBc,MAAQI,EAC7BnB,EAAgBe,OAAQ,EAChBM,IAAGC,MAAK,KACdtB,EAAgBe,OAAQ,EACxBlB,EAAKkB,MAAQG,EAAEK,QACfxB,EAAKgB,MAAQG,EAAEM,OAAAA,GAChB,EAaJ,EACDC,MAAAA,GAyBE,OAAAC,EAAA,MAAA,CAAAC,MACcC,GAAa,CAAAF,EAAA,MAAA,CAAAC,MACXC,GAAgB,CA1BPC,KACvBC,KAAK5B,WAAW6B,KAAKZ,GAAeO,EAAA,MAAA,CAAAC,MAEzBC,EAAgBI,cACPd,GAAMY,KAAKb,kBAAkBC,EAAGC,IAAK,CAAAO,EAAA,MAAA,CAAAC,MAEzCC,GAAe,CAAAF,EAAA,MAAA,CAAAO,IACfC,GAAQ,QAEnBf,EAAKV,SAAQiB,EAAAS,EAAA,CAAApB,MAEKI,EAAKxB,KAAI,iBAATwB,GAAAA,EAAKxB,KAAIyC,EAAAC,WACb,EAAIC,OACPA,IAAOnB,EAAKV,UAAW,EAAM8B,QACrBrB,GAAU,UAAVA,EAAEP,MAAoBQ,EAAKV,UAAW,GAAMG,KAAA,OAAA4B,YAAA,WAAA,MAAAd,EAKvDP,OAAAA,KAAAA,CAAAA,EAAKxB,WAOekC,KAAkBH,EAAAS,EAAA,CAAAM,UAAA,eAAAC,QAAA,SAAAC,EAI5Cb,KAAKjC,KAAI+C,EACTd,KAAK/B,KAAI8C,QACHf,KAAK1B,YAAW0C,KACnBhB,KAAK9B,gBAAe+C,SAChBjB,KAAKhB,aAAYE,eACXc,KAAKd,gBAAc,OAI3C"}