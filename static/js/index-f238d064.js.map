{"version":3,"file":"index-f238d064.js","sources":["../../../node_modules/naive-ui/es/_utils/vue/create-data-key.js","../../../node_modules/naive-ui/es/_internal/icons/Switcher.js","../../../node_modules/naive-ui/es/checkbox/src/CheckMark.js","../../../node_modules/naive-ui/es/checkbox/src/LineMark.js","../../../node_modules/naive-ui/es/checkbox/src/CheckboxGroup.js","../../../node_modules/naive-ui/es/checkbox/src/styles/index.cssr.js","../../../node_modules/naive-ui/es/checkbox/src/Checkbox.js","../../../node_modules/naive-ui/es/tree-select/src/interface.js","../../../node_modules/naive-ui/es/tree/src/interface.js","../../../node_modules/naive-ui/es/tree/src/TreeNodeSwitcher.js","../../../node_modules/naive-ui/es/tree/src/TreeNodeCheckbox.js","../../../node_modules/naive-ui/es/tree/src/TreeNodeContent.js","../../../node_modules/naive-ui/es/tree/src/dnd.js","../../../node_modules/naive-ui/es/tree/src/utils.js","../../../node_modules/naive-ui/es/tree/src/TreeNode.js","../../../node_modules/naive-ui/es/tree/src/MotionWrapper.js","../../../node_modules/naive-ui/es/tree/src/styles/index.cssr.js","../../../node_modules/naive-ui/es/tree/src/Tree.js","../../../node_modules/naive-ui/es/tree/src/keyboard.js","../../../src/views/design-space/map/types.ts","../../../src/views/design-space/map/resource-tree/index.tsx"],"sourcesContent":["export function createDataKey(key) {\n    return typeof key === 'string' ? `s-${key}` : `n-${key}`;\n}\n","import { h, defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'Switcher',\n    render() {\n        return (h(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 32 32\" },\n            h(\"path\", { d: \"M12 8l10 8l-10 8z\" })));\n    }\n});\n","import { h } from 'vue';\nexport default (h(\"svg\", { viewBox: \"0 0 64 64\", class: \"check-icon\" },\n    h(\"path\", { d: \"M50.42,16.76L22.34,39.45l-8.1-11.46c-1.12-1.58-3.3-1.96-4.88-0.84c-1.58,1.12-1.95,3.3-0.84,4.88l10.26,14.51  c0.56,0.79,1.42,1.31,2.38,1.45c0.16,0.02,0.32,0.03,0.48,0.03c0.8,0,1.57-0.27,2.2-0.78l30.99-25.03c1.5-1.21,1.74-3.42,0.52-4.92  C54.13,15.78,51.93,15.55,50.42,16.76z\" })));\n","import { h } from 'vue';\nexport default (h(\"svg\", { viewBox: \"0 0 100 100\", class: \"line-icon\" },\n    h(\"path\", { d: \"M80.2,55.5H21.4c-2.8,0-5.1-2.5-5.1-5.5l0,0c0-3,2.3-5.5,5.1-5.5h58.7c2.8,0,5.1,2.5,5.1,5.5l0,0C85.2,53.1,82.9,55.5,80.2,55.5z\" })));\n","import { h, defineComponent, provide, computed, toRef, ref, watchEffect } from 'vue';\nimport { useMergedState } from 'vooks';\nimport { useConfig, useFormItem } from '../../_mixins';\nimport { call, createInjectionKey, warnOnce } from '../../_utils';\nexport const checkboxGroupInjectionKey = createInjectionKey('n-checkbox-group');\nexport const checkboxGroupProps = {\n    min: Number,\n    max: Number,\n    size: String,\n    value: Array,\n    defaultValue: {\n        type: Array,\n        default: null\n    },\n    disabled: {\n        type: Boolean,\n        default: undefined\n    },\n    'onUpdate:value': [Function, Array],\n    onUpdateValue: [Function, Array],\n    // deprecated\n    onChange: [Function, Array]\n};\nexport default defineComponent({\n    name: 'CheckboxGroup',\n    props: checkboxGroupProps,\n    setup(props) {\n        if (process.env.NODE_ENV !== 'production') {\n            watchEffect(() => {\n                if (props.onChange !== undefined) {\n                    warnOnce('checkbox-group', '`on-change` is deprecated, please use `on-update:value` instead.');\n                }\n            });\n        }\n        const { mergedClsPrefixRef } = useConfig(props);\n        const formItem = useFormItem(props);\n        const { mergedSizeRef, mergedDisabledRef } = formItem;\n        const uncontrolledValueRef = ref(props.defaultValue);\n        const controlledValueRef = computed(() => props.value);\n        const mergedValueRef = useMergedState(controlledValueRef, uncontrolledValueRef);\n        const checkedCount = computed(() => {\n            var _a;\n            return ((_a = mergedValueRef.value) === null || _a === void 0 ? void 0 : _a.length) || 0;\n        });\n        const valueSetRef = computed(() => {\n            if (Array.isArray(mergedValueRef.value)) {\n                return new Set(mergedValueRef.value);\n            }\n            return new Set();\n        });\n        function toggleCheckbox(checked, checkboxValue) {\n            const { nTriggerFormInput, nTriggerFormChange } = formItem;\n            const { onChange, 'onUpdate:value': _onUpdateValue, onUpdateValue } = props;\n            if (Array.isArray(mergedValueRef.value)) {\n                const groupValue = Array.from(mergedValueRef.value);\n                const index = groupValue.findIndex((value) => value === checkboxValue);\n                if (checked) {\n                    if (!~index) {\n                        groupValue.push(checkboxValue);\n                        if (onUpdateValue) {\n                            call(onUpdateValue, groupValue, {\n                                actionType: 'check',\n                                value: checkboxValue\n                            });\n                        }\n                        if (_onUpdateValue) {\n                            call(_onUpdateValue, groupValue, {\n                                actionType: 'check',\n                                value: checkboxValue\n                            });\n                        }\n                        nTriggerFormInput();\n                        nTriggerFormChange();\n                        uncontrolledValueRef.value = groupValue;\n                        // deprecated\n                        if (onChange)\n                            call(onChange, groupValue);\n                    }\n                }\n                else {\n                    if (~index) {\n                        groupValue.splice(index, 1);\n                        if (onUpdateValue) {\n                            call(onUpdateValue, groupValue, {\n                                actionType: 'uncheck',\n                                value: checkboxValue\n                            });\n                        }\n                        if (_onUpdateValue) {\n                            call(_onUpdateValue, groupValue, {\n                                actionType: 'uncheck',\n                                value: checkboxValue\n                            });\n                        }\n                        if (onChange)\n                            call(onChange, groupValue); // deprecated\n                        uncontrolledValueRef.value = groupValue;\n                        nTriggerFormInput();\n                        nTriggerFormChange();\n                    }\n                }\n            }\n            else {\n                if (checked) {\n                    if (onUpdateValue) {\n                        call(onUpdateValue, [checkboxValue], {\n                            actionType: 'check',\n                            value: checkboxValue\n                        });\n                    }\n                    if (_onUpdateValue) {\n                        call(_onUpdateValue, [checkboxValue], {\n                            actionType: 'check',\n                            value: checkboxValue\n                        });\n                    }\n                    if (onChange)\n                        call(onChange, [checkboxValue]); // deprecated\n                    uncontrolledValueRef.value = [checkboxValue];\n                    nTriggerFormInput();\n                    nTriggerFormChange();\n                }\n                else {\n                    if (onUpdateValue) {\n                        call(onUpdateValue, [], {\n                            actionType: 'uncheck',\n                            value: checkboxValue\n                        });\n                    }\n                    if (_onUpdateValue) {\n                        call(_onUpdateValue, [], {\n                            actionType: 'uncheck',\n                            value: checkboxValue\n                        });\n                    }\n                    if (onChange)\n                        call(onChange, []); // deprecated\n                    uncontrolledValueRef.value = [];\n                    nTriggerFormInput();\n                    nTriggerFormChange();\n                }\n            }\n        }\n        provide(checkboxGroupInjectionKey, {\n            checkedCountRef: checkedCount,\n            maxRef: toRef(props, 'max'),\n            minRef: toRef(props, 'min'),\n            valueSetRef,\n            disabledRef: mergedDisabledRef,\n            mergedSizeRef,\n            toggleCheckbox\n        });\n        return {\n            mergedClsPrefix: mergedClsPrefixRef\n        };\n    },\n    render() {\n        return (h(\"div\", { class: `${this.mergedClsPrefix}-checkbox-group`, role: \"group\" }, this.$slots));\n    }\n});\n","import { c, cB, cE, cM, insideModal, insidePopover } from '../../../_utils/cssr';\nimport { iconSwitchTransition } from '../../../_styles/transitions/icon-switch.cssr';\n// vars:\n// --n-label-line-height\n// --n-bezier\n// --n-size\n// --n-border\n// --n-border-focus\n// --n-border-checked\n// --n-border-disabled\n// --n-border-disabled-checked\n// --n-box-shadow-focus\n// --n-color\n// --n-color-checked\n// --n-color-table\n// --n-color-table-modal\n// --n-color-disabled\n// --n-color-disabled-checked\n// --n-text-color\n// --n-text-color-disabled\n// --n-check-mark-color\n// --n-check-mark-color-disabled\n// --n-check-mark-color-disabled-checked\n// --n-border-radius\n// --n-font-size\n// --n-label-padding\nexport default c([cB('checkbox', `\n line-height: var(--n-label-line-height);\n font-size: var(--n-font-size);\n outline: none;\n cursor: pointer;\n display: inline-flex;\n flex-wrap: nowrap;\n align-items: flex-start;\n word-break: break-word;\n --n-merged-color-table: var(--n-color-table);\n `, [c('&:hover', [cB('checkbox-box', [cE('border', {\n  border: 'var(--n-border-checked)'\n})])]), c('&:focus:not(:active)', [cB('checkbox-box', [cE('border', `\n border: var(--n-border-focus);\n box-shadow: var(--n-box-shadow-focus);\n `)])]), cM('inside-table', [cB('checkbox-box', `\n background-color: var(--n-merged-color-table);\n `)]), cM('checked', [cB('checkbox-box', `\n background-color: var(--n-color-checked);\n `, [cB('checkbox-icon', [\n// if not set width to 100%, safari & old chrome won't display the icon\nc('.check-icon', `\n opacity: 1;\n transform: scale(1);\n `)])])]), cM('indeterminate', [cB('checkbox-box', [cB('checkbox-icon', [c('.check-icon', `\n opacity: 0;\n transform: scale(.5);\n `), c('.line-icon', `\n opacity: 1;\n transform: scale(1);\n `)])])]), cM('checked, indeterminate', [c('&:focus:not(:active)', [cB('checkbox-box', [cE('border', `\n border: var(--n-border-checked);\n box-shadow: var(--n-box-shadow-focus);\n `)])]), cB('checkbox-box', `\n background-color: var(--n-color-checked);\n border-left: 0;\n border-top: 0;\n `, [cE('border', {\n  border: 'var(--n-border-checked)'\n})])]), cM('disabled', {\n  cursor: 'not-allowed'\n}, [cM('checked', [cB('checkbox-box', `\n background-color: var(--n-color-disabled-checked);\n `, [cE('border', {\n  border: 'var(--n-border-disabled-checked)'\n}), cB('checkbox-icon', [c('.check-icon, .line-icon', {\n  fill: 'var(--n-check-mark-color-disabled-checked)'\n})])])]), cB('checkbox-box', `\n background-color: var(--n-color-disabled);\n `, [cE('border', {\n  border: 'var(--n-border-disabled)'\n}), cB('checkbox-icon', [c('.check-icon, .line-icon', {\n  fill: 'var(--n-check-mark-color-disabled)'\n})])]), cE('label', {\n  color: 'var(--n-text-color-disabled)'\n})]), cB('checkbox-box-wrapper', `\n position: relative;\n width: var(--n-size);\n flex-shrink: 0;\n flex-grow: 0;\n user-select: none;\n -webkit-user-select: none;\n `), cB('checkbox-box', `\n position: absolute;\n left: 0;\n top: 50%;\n transform: translateY(-50%);\n height: var(--n-size);\n width: var(--n-size);\n display: inline-block;\n box-sizing: border-box;\n border-radius: var(--n-border-radius);\n background-color: var(--n-color);\n transition: background-color 0.3s var(--n-bezier);\n `, [cE('border', `\n transition:\n border-color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n border-radius: inherit;\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n border: var(--n-border);\n `), cB('checkbox-icon', `\n display: flex;\n align-items: center;\n justify-content: center;\n position: absolute;\n left: 1px;\n right: 1px;\n top: 1px;\n bottom: 1px;\n `, [c('.check-icon, .line-icon', `\n width: 100%;\n fill: var(--n-check-mark-color);\n opacity: 0;\n transform: scale(0.5);\n transform-origin: center;\n transition:\n fill 0.3s var(--n-bezier),\n transform 0.3s var(--n-bezier),\n opacity 0.3s var(--n-bezier),\n border-color 0.3s var(--n-bezier);\n `), iconSwitchTransition({\n  left: '1px',\n  top: '1px'\n})])]), cE('label', `\n color: var(--n-text-color);\n transition: color .3s var(--n-bezier);\n user-select: none;\n -webkit-user-select: none;\n padding: var(--n-label-padding);\n font-weight: var(--n-label-font-weight);\n `, [c('&:empty', {\n  display: 'none'\n})])]),\n// modal table header checkbox\ninsideModal(cB('checkbox', `\n --n-merged-color-table: var(--n-color-table-modal);\n `)),\n// popover table header checkbox\ninsidePopover(cB('checkbox', `\n --n-merged-color-table: var(--n-color-table-popover);\n `))]);","import { h, defineComponent, computed, inject, ref, toRef, watchEffect } from 'vue';\nimport { useMergedState, useMemo } from 'vooks';\nimport { createId } from 'seemly';\nimport { on } from 'evtd';\nimport { useConfig, useFormItem, useTheme, useThemeClass } from '../../_mixins';\nimport { NIconSwitchTransition } from '../../_internal';\nimport { call, createKey, warnOnce } from '../../_utils';\nimport { checkboxLight } from '../styles';\nimport CheckMark from './CheckMark';\nimport LineMark from './LineMark';\nimport { checkboxGroupInjectionKey } from './CheckboxGroup';\nimport style from './styles/index.cssr';\nimport { useRtl } from '../../_mixins/use-rtl';\nexport const checkboxProps = Object.assign(Object.assign({}, useTheme.props), { size: String, checked: {\n        type: [Boolean, String, Number],\n        default: undefined\n    }, defaultChecked: {\n        type: [Boolean, String, Number],\n        default: false\n    }, value: [String, Number], disabled: {\n        type: Boolean,\n        default: undefined\n    }, indeterminate: Boolean, label: String, focusable: {\n        type: Boolean,\n        default: true\n    }, checkedValue: {\n        type: [Boolean, String, Number],\n        default: true\n    }, uncheckedValue: {\n        type: [Boolean, String, Number],\n        default: false\n    }, 'onUpdate:checked': [Function, Array], onUpdateChecked: [Function, Array], \n    // private\n    privateInsideTable: Boolean, \n    // deprecated\n    onChange: [Function, Array] });\nexport default defineComponent({\n    name: 'Checkbox',\n    props: checkboxProps,\n    setup(props) {\n        if (process.env.NODE_ENV !== 'production') {\n            watchEffect(() => {\n                if (props.onChange) {\n                    warnOnce('checkbox', '`on-change` is deprecated, please use `on-update:checked` instead.');\n                }\n            });\n        }\n        const selfRef = ref(null);\n        const { mergedClsPrefixRef, inlineThemeDisabled, mergedRtlRef } = useConfig(props);\n        const formItem = useFormItem(props, {\n            mergedSize(NFormItem) {\n                const { size } = props;\n                if (size !== undefined)\n                    return size;\n                if (NCheckboxGroup) {\n                    const { value: mergedSize } = NCheckboxGroup.mergedSizeRef;\n                    if (mergedSize !== undefined) {\n                        return mergedSize;\n                    }\n                }\n                if (NFormItem) {\n                    const { mergedSize } = NFormItem;\n                    if (mergedSize !== undefined)\n                        return mergedSize.value;\n                }\n                return 'medium';\n            },\n            mergedDisabled(NFormItem) {\n                const { disabled } = props;\n                if (disabled !== undefined)\n                    return disabled;\n                if (NCheckboxGroup) {\n                    if (NCheckboxGroup.disabledRef.value)\n                        return true;\n                    const { maxRef: { value: max }, checkedCountRef } = NCheckboxGroup;\n                    if (max !== undefined &&\n                        checkedCountRef.value >= max &&\n                        !renderedCheckedRef.value) {\n                        return true;\n                    }\n                    const { minRef: { value: min } } = NCheckboxGroup;\n                    if (min !== undefined &&\n                        checkedCountRef.value <= min &&\n                        renderedCheckedRef.value) {\n                        return true;\n                    }\n                }\n                if (NFormItem) {\n                    return NFormItem.disabled.value;\n                }\n                return false;\n            }\n        });\n        const { mergedDisabledRef, mergedSizeRef } = formItem;\n        const NCheckboxGroup = inject(checkboxGroupInjectionKey, null);\n        const uncontrolledCheckedRef = ref(props.defaultChecked);\n        const controlledCheckedRef = toRef(props, 'checked');\n        const mergedCheckedRef = useMergedState(controlledCheckedRef, uncontrolledCheckedRef);\n        const renderedCheckedRef = useMemo(() => {\n            if (NCheckboxGroup) {\n                const groupValueSet = NCheckboxGroup.valueSetRef.value;\n                if (groupValueSet && props.value !== undefined) {\n                    return groupValueSet.has(props.value);\n                }\n                return false;\n            }\n            else {\n                return mergedCheckedRef.value === props.checkedValue;\n            }\n        });\n        const themeRef = useTheme('Checkbox', '-checkbox', style, checkboxLight, props, mergedClsPrefixRef);\n        function toggle(e) {\n            if (NCheckboxGroup && props.value !== undefined) {\n                NCheckboxGroup.toggleCheckbox(!renderedCheckedRef.value, props.value);\n            }\n            else {\n                const { onChange, 'onUpdate:checked': _onUpdateCheck, onUpdateChecked } = props;\n                const { nTriggerFormInput, nTriggerFormChange } = formItem;\n                const nextChecked = renderedCheckedRef.value\n                    ? props.uncheckedValue\n                    : props.checkedValue;\n                if (_onUpdateCheck) {\n                    call(_onUpdateCheck, nextChecked, e);\n                }\n                if (onUpdateChecked) {\n                    call(onUpdateChecked, nextChecked, e);\n                }\n                if (onChange)\n                    call(onChange, nextChecked, e); // deprecated\n                nTriggerFormInput();\n                nTriggerFormChange();\n                uncontrolledCheckedRef.value = nextChecked;\n            }\n        }\n        function handleClick(e) {\n            if (!mergedDisabledRef.value) {\n                toggle(e);\n            }\n        }\n        function handleKeyUp(e) {\n            if (mergedDisabledRef.value)\n                return;\n            switch (e.key) {\n                case ' ':\n                case 'Enter':\n                    toggle(e);\n            }\n        }\n        function handleKeyDown(e) {\n            switch (e.key) {\n                case ' ':\n                    e.preventDefault();\n            }\n        }\n        const exposedMethods = {\n            focus: () => {\n                var _a;\n                (_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.focus();\n            },\n            blur: () => {\n                var _a;\n                (_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.blur();\n            }\n        };\n        const rtlEnabledRef = useRtl('Checkbox', mergedRtlRef, mergedClsPrefixRef);\n        const cssVarsRef = computed(() => {\n            const { value: mergedSize } = mergedSizeRef;\n            const { common: { cubicBezierEaseInOut }, self: { borderRadius, color, colorChecked, colorDisabled, colorTableHeader, colorTableHeaderModal, colorTableHeaderPopover, checkMarkColor, checkMarkColorDisabled, border, borderFocus, borderDisabled, borderChecked, boxShadowFocus, textColor, textColorDisabled, checkMarkColorDisabledChecked, colorDisabledChecked, borderDisabledChecked, labelPadding, labelLineHeight, labelFontWeight, [createKey('fontSize', mergedSize)]: fontSize, [createKey('size', mergedSize)]: size } } = themeRef.value;\n            return {\n                '--n-label-line-height': labelLineHeight,\n                '--n-label-font-weight': labelFontWeight,\n                '--n-size': size,\n                '--n-bezier': cubicBezierEaseInOut,\n                '--n-border-radius': borderRadius,\n                '--n-border': border,\n                '--n-border-checked': borderChecked,\n                '--n-border-focus': borderFocus,\n                '--n-border-disabled': borderDisabled,\n                '--n-border-disabled-checked': borderDisabledChecked,\n                '--n-box-shadow-focus': boxShadowFocus,\n                '--n-color': color,\n                '--n-color-checked': colorChecked,\n                '--n-color-table': colorTableHeader,\n                '--n-color-table-modal': colorTableHeaderModal,\n                '--n-color-table-popover': colorTableHeaderPopover,\n                '--n-color-disabled': colorDisabled,\n                '--n-color-disabled-checked': colorDisabledChecked,\n                '--n-text-color': textColor,\n                '--n-text-color-disabled': textColorDisabled,\n                '--n-check-mark-color': checkMarkColor,\n                '--n-check-mark-color-disabled': checkMarkColorDisabled,\n                '--n-check-mark-color-disabled-checked': checkMarkColorDisabledChecked,\n                '--n-font-size': fontSize,\n                '--n-label-padding': labelPadding\n            };\n        });\n        const themeClassHandle = inlineThemeDisabled\n            ? useThemeClass('checkbox', computed(() => mergedSizeRef.value[0]), cssVarsRef, props)\n            : undefined;\n        return Object.assign(formItem, exposedMethods, {\n            rtlEnabled: rtlEnabledRef,\n            selfRef,\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedDisabled: mergedDisabledRef,\n            renderedChecked: renderedCheckedRef,\n            mergedTheme: themeRef,\n            labelId: createId(),\n            handleClick,\n            handleKeyUp,\n            handleKeyDown,\n            cssVars: inlineThemeDisabled ? undefined : cssVarsRef,\n            themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n            onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender\n        });\n    },\n    render() {\n        var _a;\n        const { $slots, renderedChecked, mergedDisabled, indeterminate, privateInsideTable, cssVars, labelId, label, mergedClsPrefix, focusable, handleKeyUp, handleKeyDown, handleClick } = this;\n        (_a = this.onRender) === null || _a === void 0 ? void 0 : _a.call(this);\n        return (h(\"div\", { ref: \"selfRef\", class: [\n                `${mergedClsPrefix}-checkbox`,\n                this.themeClass,\n                this.rtlEnabled && `${mergedClsPrefix}-checkbox--rtl`,\n                renderedChecked && `${mergedClsPrefix}-checkbox--checked`,\n                mergedDisabled && `${mergedClsPrefix}-checkbox--disabled`,\n                indeterminate && `${mergedClsPrefix}-checkbox--indeterminate`,\n                privateInsideTable && `${mergedClsPrefix}-checkbox--inside-table`\n            ], tabindex: mergedDisabled || !focusable ? undefined : 0, role: \"checkbox\", \"aria-checked\": indeterminate ? 'mixed' : renderedChecked, \"aria-labelledby\": labelId, style: cssVars, onKeyup: handleKeyUp, onKeydown: handleKeyDown, onClick: handleClick, onMousedown: () => {\n                on('selectstart', window, (e) => {\n                    e.preventDefault();\n                }, {\n                    once: true\n                });\n            } },\n            h(\"div\", { class: `${mergedClsPrefix}-checkbox-box-wrapper` },\n                \"\\u00A0\",\n                h(\"div\", { class: `${mergedClsPrefix}-checkbox-box` },\n                    h(NIconSwitchTransition, null, {\n                        default: () => this.indeterminate ? (h(\"div\", { key: \"indeterminate\", class: `${mergedClsPrefix}-checkbox-icon` }, LineMark)) : (h(\"div\", { key: \"check\", class: `${mergedClsPrefix}-checkbox-icon` }, CheckMark))\n                    }),\n                    h(\"div\", { class: `${mergedClsPrefix}-checkbox-box__border` }))),\n            label !== null || $slots.default ? (h(\"span\", { class: `${mergedClsPrefix}-checkbox__label`, id: labelId }, $slots.default ? $slots.default() : label)) : null));\n    }\n});\n","import { createInjectionKey } from '../../_utils';\nexport const treeSelectInjectionKey = createInjectionKey('n-tree-select');\n","import { createInjectionKey } from '../../_utils';\nexport const treeInjectionKey = createInjectionKey('n-tree');\n","import { h, defineComponent, inject } from 'vue';\nimport { SwitcherIcon } from '../../_internal/icons';\nimport { NIconSwitchTransition, NBaseLoading, NBaseIcon } from '../../_internal';\nimport { treeInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'NTreeSwitcher',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        expanded: Boolean,\n        selected: Boolean,\n        hide: Boolean,\n        loading: Boolean,\n        onClick: Function\n    },\n    setup(props) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const { renderSwitcherIconRef } = inject(treeInjectionKey, null);\n        return () => {\n            const { clsPrefix } = props;\n            return (h(\"span\", { \"data-switcher\": true, class: [\n                    `${clsPrefix}-tree-node-switcher`,\n                    props.expanded && `${clsPrefix}-tree-node-switcher--expanded`,\n                    props.hide && `${clsPrefix}-tree-node-switcher--hide`\n                ], onClick: props.onClick },\n                h(\"div\", { class: `${clsPrefix}-tree-node-switcher__icon` },\n                    h(NIconSwitchTransition, null, {\n                        default: () => {\n                            if (props.loading) {\n                                return (h(NBaseLoading, { clsPrefix: clsPrefix, key: \"loading\", radius: 85, strokeWidth: 20 }));\n                            }\n                            const { value: renderSwitcherIcon } = renderSwitcherIconRef;\n                            return renderSwitcherIcon ? (renderSwitcherIcon({\n                                expanded: props.expanded,\n                                selected: props.selected\n                            })) : (h(NBaseIcon, { clsPrefix: clsPrefix, key: \"switcher\" }, { default: () => h(SwitcherIcon, null) }));\n                        }\n                    }))));\n        };\n    }\n});\n","import { h, defineComponent, inject } from 'vue';\nimport { NCheckbox } from '../../checkbox';\nimport { treeInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'NTreeNodeCheckbox',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        right: Boolean,\n        focusable: Boolean,\n        disabled: Boolean,\n        checked: Boolean,\n        indeterminate: Boolean,\n        onCheck: Function\n    },\n    setup(props) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const NTree = inject(treeInjectionKey);\n        function doCheck(value) {\n            const { onCheck } = props;\n            if (onCheck) {\n                onCheck(value);\n            }\n        }\n        function handleUpdateValue(value) {\n            if (props.indeterminate) {\n                doCheck(false);\n            }\n            else {\n                doCheck(value);\n            }\n        }\n        return {\n            handleUpdateValue,\n            mergedTheme: NTree.mergedThemeRef\n        };\n    },\n    render() {\n        const { clsPrefix, mergedTheme, checked, indeterminate, disabled, focusable, handleUpdateValue } = this;\n        return (h(\"span\", { class: [\n                `${clsPrefix}-tree-node-checkbox`,\n                this.right && `${clsPrefix}-tree-node-checkbox--right`\n            ], \"data-checkbox\": true },\n            h(NCheckbox, { focusable: focusable, disabled: disabled, theme: mergedTheme.peers.Checkbox, themeOverrides: mergedTheme.peerOverrides.Checkbox, checked: checked, indeterminate: indeterminate, onUpdateChecked: handleUpdateValue })));\n    }\n});\n","import { h, defineComponent, ref, inject } from 'vue';\nimport { render } from '../../_utils';\nimport { treeInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'TreeNodeContent',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        disabled: Boolean,\n        checked: Boolean,\n        selected: Boolean,\n        onClick: Function,\n        onDragstart: Function,\n        tmNode: {\n            type: Object,\n            required: true\n        },\n        nodeProps: Object\n    },\n    setup(props) {\n        const { renderLabelRef, renderPrefixRef, renderSuffixRef, labelFieldRef } = \n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        inject(treeInjectionKey);\n        const selfRef = ref(null);\n        function doClick(e) {\n            const { onClick } = props;\n            if (onClick)\n                onClick(e);\n        }\n        function handleClick(e) {\n            doClick(e);\n        }\n        return {\n            selfRef,\n            renderLabel: renderLabelRef,\n            renderPrefix: renderPrefixRef,\n            renderSuffix: renderSuffixRef,\n            labelField: labelFieldRef,\n            handleClick\n        };\n    },\n    render() {\n        const { clsPrefix, labelField, nodeProps, checked = false, selected = false, renderLabel, renderPrefix, renderSuffix, handleClick, onDragstart, tmNode: { rawNode, rawNode: { prefix, suffix, [labelField]: label } } } = this;\n        return (h(\"span\", Object.assign({}, nodeProps, { ref: \"selfRef\", class: [`${clsPrefix}-tree-node-content`, nodeProps === null || nodeProps === void 0 ? void 0 : nodeProps.class], onClick: handleClick, draggable: onDragstart === undefined ? undefined : true, onDragstart: onDragstart }),\n            renderPrefix || prefix ? (h(\"div\", { class: `${clsPrefix}-tree-node-content__prefix` }, renderPrefix\n                ? renderPrefix({\n                    option: rawNode,\n                    selected,\n                    checked\n                })\n                : render(prefix))) : null,\n            h(\"div\", { class: `${clsPrefix}-tree-node-content__text` }, renderLabel\n                ? renderLabel({\n                    option: rawNode,\n                    selected,\n                    checked\n                })\n                : render(label)),\n            renderSuffix || suffix ? (h(\"div\", { class: `${clsPrefix}-tree-node-content__suffix` }, renderSuffix\n                ? renderSuffix({\n                    option: rawNode,\n                    selected,\n                    checked\n                })\n                : render(suffix))) : null));\n    }\n});\n","import { h } from 'vue';\nexport function renderDropMark({ position, offsetLevel, indent, el }) {\n    const style = {\n        position: 'absolute',\n        boxSizing: 'border-box',\n        right: 0\n    };\n    if (position === 'inside') {\n        style.left = 0;\n        style.top = 0;\n        style.bottom = 0;\n        style.borderRadius = 'inherit';\n        style.boxShadow = 'inset 0 0 0 2px var(--n-drop-mark-color)';\n    }\n    else {\n        const cssPosition = position === 'before' ? 'top' : 'bottom';\n        style[cssPosition] = 0;\n        // The left prop should be modified when tree's style is changed\n        // Maybe it is possible to use content left\n        style.left = `${el.offsetLeft + 6 - offsetLevel * indent}px`;\n        style.height = '2px';\n        style.backgroundColor = 'var(--n-drop-mark-color)';\n        style.transformOrigin = cssPosition;\n        style.borderRadius = '1px';\n        style.transform =\n            position === 'before' ? 'translateY(-4px)' : 'translateY(4px)';\n    }\n    return h(\"div\", { style: style });\n}\nexport function defaultAllowDrop({ dropPosition, node }) {\n    if (node.isLeaf === false)\n        return true;\n    if (node.children) {\n        return true;\n    }\n    return dropPosition !== 'inside';\n}\n","import { computed } from 'vue';\nimport { isBrowser } from '../../_utils';\nexport function useMergedCheckStrategy(props) {\n    return computed(() => (props.leafOnly ? 'child' : props.checkStrategy));\n}\nexport function isNodeDisabled(node, disabledField) {\n    return !!node.rawNode[disabledField];\n}\nfunction traverse(nodes, childrenField, callback, callbackAfter) {\n    nodes === null || nodes === void 0 ? void 0 : nodes.forEach((node) => {\n        callback(node);\n        traverse(node[childrenField], childrenField, callback, callbackAfter);\n        callbackAfter(node);\n    });\n}\nexport function keysWithFilter(nodes, pattern, keyField, childrenField, filter) {\n    const keys = new Set();\n    const highlightKeySet = new Set();\n    const path = [];\n    traverse(nodes, childrenField, (node) => {\n        path.push(node);\n        if (filter(pattern, node)) {\n            highlightKeySet.add(node[keyField]);\n            for (let i = path.length - 2; i >= 0; --i) {\n                if (!keys.has(path[i][keyField])) {\n                    keys.add(path[i][keyField]);\n                }\n                else {\n                    return;\n                }\n            }\n        }\n    }, () => {\n        path.pop();\n    });\n    return {\n        expandedKeys: Array.from(keys),\n        highlightKeySet\n    };\n}\nconst emptyImage = null;\nif (isBrowser && Image) {\n    const emptyImage = new Image();\n    emptyImage.src =\n        'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n}\nexport { emptyImage };\nexport function filterTree(tree, filter, pattern, keyField, childrenField) {\n    const visitedTailKeys = new Set();\n    const visitedNonTailKeys = new Set();\n    const highlightKeySet = new Set();\n    const expandedKeys = [];\n    const filteredTree = [];\n    const path = [];\n    function visit(t) {\n        t.forEach((n) => {\n            path.push(n);\n            if (filter(pattern, n)) {\n                visitedTailKeys.add(n[keyField]);\n                highlightKeySet.add(n[keyField]);\n                for (let i = path.length - 2; i >= 0; --i) {\n                    const key = path[i][keyField];\n                    if (!visitedNonTailKeys.has(key)) {\n                        visitedNonTailKeys.add(key);\n                        if (visitedTailKeys.has(key)) {\n                            visitedTailKeys.delete(key);\n                        }\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n            const children = n[childrenField];\n            if (children) {\n                visit(children);\n            }\n            path.pop();\n        });\n    }\n    visit(tree);\n    function build(t, sibs) {\n        t.forEach((n) => {\n            const key = n[keyField];\n            const isVisitedTail = visitedTailKeys.has(key);\n            const isVisitedNonTail = visitedNonTailKeys.has(key);\n            if (!isVisitedTail && !isVisitedNonTail)\n                return;\n            const children = n[childrenField];\n            if (children) {\n                if (isVisitedTail) {\n                    // If it is visited path tail, use origin node\n                    sibs.push(n);\n                }\n                else {\n                    // It it is not visited path tail, use cloned node\n                    expandedKeys.push(key);\n                    const clonedNode = Object.assign(Object.assign({}, n), { [childrenField]: [] });\n                    sibs.push(clonedNode);\n                    build(children, clonedNode[childrenField]);\n                }\n            }\n            else {\n                sibs.push(n);\n            }\n        });\n    }\n    build(tree, filteredTree);\n    return {\n        filteredTree,\n        highlightKeySet,\n        expandedKeys\n    };\n}\n","import { h, inject, computed, defineComponent, ref, onMounted } from 'vue';\nimport { useMemo } from 'vooks';\nimport { happensIn, repeat } from 'seemly';\nimport { createDataKey } from '../../_utils';\nimport NTreeNodeSwitcher from './TreeNodeSwitcher';\nimport NTreeNodeCheckbox from './TreeNodeCheckbox';\nimport NTreeNodeContent from './TreeNodeContent';\nimport { treeInjectionKey } from './interface';\nimport { renderDropMark } from './dnd';\nimport { isNodeDisabled } from './utils';\nconst TreeNode = defineComponent({\n    name: 'TreeNode',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        tmNode: {\n            type: Object,\n            required: true\n        }\n    },\n    setup(props) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const NTree = inject(treeInjectionKey);\n        const { droppingNodeParentRef, droppingMouseNodeRef, draggingNodeRef, droppingPositionRef, droppingOffsetLevelRef, nodePropsRef, indentRef, blockLineRef, checkboxPlacementRef, checkOnClickRef, disabledFieldRef } = NTree;\n        const checkboxDisabledRef = useMemo(() => !!props.tmNode.rawNode.checkboxDisabled);\n        const nodeIsDisabledRef = useMemo(() => {\n            return isNodeDisabled(props.tmNode, disabledFieldRef.value);\n        });\n        const disabledRef = useMemo(() => NTree.disabledRef.value || nodeIsDisabledRef.value);\n        const resolvedNodePropsRef = computed(() => {\n            const { value: nodeProps } = nodePropsRef;\n            if (!nodeProps)\n                return undefined;\n            return nodeProps({ option: props.tmNode.rawNode });\n        });\n        // used for drag and drop\n        const contentInstRef = ref(null);\n        // must be non-reactive\n        const contentElRef = { value: null };\n        onMounted(() => {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            contentElRef.value = contentInstRef.value.$el;\n        });\n        function handleSwitcherClick() {\n            const { tmNode } = props;\n            if (!tmNode.isLeaf && !tmNode.shallowLoaded) {\n                if (!NTree.loadingKeysRef.value.has(tmNode.key)) {\n                    NTree.loadingKeysRef.value.add(tmNode.key);\n                }\n                else {\n                    return;\n                }\n                const { onLoadRef: { value: onLoad } } = NTree;\n                if (onLoad) {\n                    void onLoad(tmNode.rawNode)\n                        .then((value) => {\n                        if (value !== false) {\n                            NTree.handleSwitcherClick(tmNode);\n                        }\n                    })\n                        .finally(() => {\n                        NTree.loadingKeysRef.value.delete(tmNode.key);\n                    });\n                }\n            }\n            else {\n                NTree.handleSwitcherClick(tmNode);\n            }\n        }\n        const selectableRef = useMemo(() => !nodeIsDisabledRef.value &&\n            NTree.selectableRef.value &&\n            (NTree.internalTreeSelect\n                ? NTree.mergedCheckStrategyRef.value !== 'child' ||\n                    (NTree.multipleRef.value && NTree.cascadeRef.value) ||\n                    props.tmNode.isLeaf\n                : true));\n        const checkableRef = useMemo(() => NTree.checkableRef.value &&\n            (NTree.cascadeRef.value ||\n                NTree.mergedCheckStrategyRef.value !== 'child' ||\n                props.tmNode.isLeaf));\n        const checkedRef = useMemo(() => NTree.displayedCheckedKeysRef.value.includes(props.tmNode.key));\n        const mergedCheckOnClickRef = useMemo(() => {\n            const { value: checkable } = checkableRef;\n            if (!checkable)\n                return false;\n            const { value: checkOnClick } = checkOnClickRef;\n            if (typeof checkOnClick === 'boolean') {\n                return checkOnClick;\n            }\n            return checkOnClick(props.tmNode.rawNode);\n        });\n        function _handleClick(e) {\n            const { value: expandOnClick } = NTree.expandOnClickRef;\n            const { value: selectable } = selectableRef;\n            const { value: mergedCheckOnClick } = mergedCheckOnClickRef;\n            if (!selectable && !expandOnClick && !mergedCheckOnClick)\n                return;\n            if (happensIn(e, 'checkbox') || happensIn(e, 'switcher'))\n                return;\n            const { tmNode } = props;\n            if (selectable) {\n                NTree.handleSelect(tmNode);\n            }\n            if (expandOnClick && !tmNode.isLeaf) {\n                handleSwitcherClick();\n            }\n            if (mergedCheckOnClick) {\n                handleCheck(!checkedRef.value);\n            }\n        }\n        function handleContentClick(e) {\n            var _a, _b;\n            if (blockLineRef.value)\n                return;\n            if (!disabledRef.value)\n                _handleClick(e);\n            (_b = (_a = resolvedNodePropsRef.value) === null || _a === void 0 ? void 0 : _a.onClick) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        }\n        function handleLineClick(e) {\n            var _a, _b;\n            if (!blockLineRef.value)\n                return;\n            if (!disabledRef.value) {\n                _handleClick(e);\n            }\n            (_b = (_a = resolvedNodePropsRef.value) === null || _a === void 0 ? void 0 : _a.onClick) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        }\n        function handleCheck(checked) {\n            NTree.handleCheck(props.tmNode, checked);\n        }\n        // Dnd\n        function handleDragStart(e) {\n            NTree.handleDragStart({\n                event: e,\n                node: props.tmNode\n            });\n        }\n        function handleDragEnter(e) {\n            if (e.currentTarget !== e.target) {\n                return;\n            }\n            NTree.handleDragEnter({\n                event: e,\n                node: props.tmNode\n            });\n        }\n        function handleDragOver(e) {\n            e.preventDefault(); // if not prevent, drop event won't be fired...\n            NTree.handleDragOver({\n                event: e,\n                node: props.tmNode\n            });\n        }\n        function handleDragEnd(e) {\n            NTree.handleDragEnd({\n                event: e,\n                node: props.tmNode\n            });\n        }\n        function handleDragLeave(e) {\n            if (e.currentTarget !== e.target) {\n                return;\n            }\n            NTree.handleDragLeave({\n                event: e,\n                node: props.tmNode\n            });\n        }\n        function handleDrop(e) {\n            e.preventDefault();\n            if (droppingPositionRef.value !== null) {\n                NTree.handleDrop({\n                    event: e,\n                    node: props.tmNode,\n                    dropPosition: droppingPositionRef.value\n                });\n            }\n        }\n        return {\n            showDropMark: useMemo(() => {\n                const { value: draggingNode } = draggingNodeRef;\n                if (!draggingNode)\n                    return;\n                const { value: droppingPosition } = droppingPositionRef;\n                if (!droppingPosition)\n                    return;\n                const { value: droppingMouseNode } = droppingMouseNodeRef;\n                if (!droppingMouseNode) {\n                    return;\n                }\n                const { tmNode } = props;\n                if (tmNode.key === droppingMouseNode.key)\n                    return true;\n                return false;\n            }),\n            showDropMarkAsParent: useMemo(() => {\n                const { value: droppingNodeParent } = droppingNodeParentRef;\n                if (!droppingNodeParent)\n                    return false;\n                const { tmNode } = props;\n                const { value: droppingPosition } = droppingPositionRef;\n                if (droppingPosition === 'before' || droppingPosition === 'after') {\n                    return droppingNodeParent.key === tmNode.key;\n                }\n                return false;\n            }),\n            pending: useMemo(() => NTree.pendingNodeKeyRef.value === props.tmNode.key),\n            loading: useMemo(() => NTree.loadingKeysRef.value.has(props.tmNode.key)),\n            highlight: useMemo(() => {\n                var _a;\n                return (_a = NTree.highlightKeySetRef.value) === null || _a === void 0 ? void 0 : _a.has(props.tmNode.key);\n            }),\n            checked: checkedRef,\n            indeterminate: useMemo(() => NTree.displayedIndeterminateKeysRef.value.includes(props.tmNode.key)),\n            selected: useMemo(() => NTree.mergedSelectedKeysRef.value.includes(props.tmNode.key)),\n            expanded: useMemo(() => NTree.mergedExpandedKeysRef.value.includes(props.tmNode.key)),\n            disabled: disabledRef,\n            checkable: checkableRef,\n            mergedCheckOnClick: mergedCheckOnClickRef,\n            checkboxDisabled: checkboxDisabledRef,\n            selectable: selectableRef,\n            expandOnClick: NTree.expandOnClickRef,\n            internalScrollable: NTree.internalScrollableRef,\n            draggable: NTree.draggableRef,\n            blockLine: blockLineRef,\n            nodeProps: resolvedNodePropsRef,\n            checkboxFocusable: NTree.internalCheckboxFocusableRef,\n            droppingPosition: droppingPositionRef,\n            droppingOffsetLevel: droppingOffsetLevelRef,\n            indent: indentRef,\n            checkboxPlacement: checkboxPlacementRef,\n            contentInstRef,\n            contentElRef,\n            handleCheck,\n            handleDrop,\n            handleDragStart,\n            handleDragEnter,\n            handleDragOver,\n            handleDragEnd,\n            handleDragLeave,\n            handleLineClick,\n            handleContentClick,\n            handleSwitcherClick\n        };\n    },\n    render() {\n        const { tmNode, clsPrefix, checkable, expandOnClick, selectable, selected, checked, highlight, draggable, blockLine, indent, disabled, pending, internalScrollable, nodeProps, checkboxPlacement } = this;\n        // drag start not inside\n        // it need to be append to node itself, not wrapper\n        const dragEventHandlers = draggable && !disabled\n            ? {\n                onDragenter: this.handleDragEnter,\n                onDragleave: this.handleDragLeave,\n                onDragend: this.handleDragEnd,\n                onDrop: this.handleDrop,\n                onDragover: this.handleDragOver\n            }\n            : undefined;\n        // In non virtual mode, there's no evidence that which element should be\n        // scrolled to, so we need data-key to query the target element.\n        const dataKey = internalScrollable ? createDataKey(tmNode.key) : undefined;\n        const checkboxOnRight = checkboxPlacement === 'right';\n        const checkboxNode = checkable ? (h(NTreeNodeCheckbox, { right: checkboxOnRight, focusable: this.checkboxFocusable, disabled: disabled || this.checkboxDisabled, clsPrefix: clsPrefix, checked: this.checked, indeterminate: this.indeterminate, onCheck: this.handleCheck })) : null;\n        return (h(\"div\", Object.assign({ class: `${clsPrefix}-tree-node-wrapper` }, dragEventHandlers),\n            h(\"div\", Object.assign({}, (blockLine ? nodeProps : undefined), { class: [\n                    `${clsPrefix}-tree-node`,\n                    {\n                        [`${clsPrefix}-tree-node--selected`]: selected,\n                        [`${clsPrefix}-tree-node--checkable`]: checkable,\n                        [`${clsPrefix}-tree-node--highlight`]: highlight,\n                        [`${clsPrefix}-tree-node--pending`]: pending,\n                        [`${clsPrefix}-tree-node--disabled`]: disabled,\n                        [`${clsPrefix}-tree-node--selectable`]: selectable,\n                        [`${clsPrefix}-tree-node--clickable`]: selectable || expandOnClick || this.mergedCheckOnClick\n                    },\n                    nodeProps === null || nodeProps === void 0 ? void 0 : nodeProps.class\n                ], \"data-key\": dataKey, draggable: draggable && blockLine, onClick: this.handleLineClick, onDragstart: draggable && blockLine && !disabled\n                    ? this.handleDragStart\n                    : undefined }),\n                repeat(tmNode.level, h(\"div\", { class: `${clsPrefix}-tree-node-indent` },\n                    h(\"div\", { style: { width: `${indent}px` } }))),\n                h(NTreeNodeSwitcher, { clsPrefix: clsPrefix, expanded: this.expanded, selected: selected, loading: this.loading, hide: tmNode.isLeaf, onClick: this.handleSwitcherClick }),\n                !checkboxOnRight ? checkboxNode : null,\n                h(NTreeNodeContent, { ref: \"contentInstRef\", clsPrefix: clsPrefix, checked: checked, selected: selected, onClick: this.handleContentClick, nodeProps: blockLine ? undefined : nodeProps, onDragstart: draggable && !blockLine && !disabled\n                        ? this.handleDragStart\n                        : undefined, tmNode: tmNode }),\n                draggable\n                    ? this.showDropMark\n                        ? renderDropMark({\n                            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                            el: this.contentElRef.value,\n                            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                            position: this.droppingPosition,\n                            offsetLevel: this.droppingOffsetLevel,\n                            indent\n                        })\n                        : this.showDropMarkAsParent\n                            ? renderDropMark({\n                                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                                el: this.contentElRef.value,\n                                position: 'inside',\n                                offsetLevel: this.droppingOffsetLevel,\n                                indent\n                            })\n                            : null\n                    : null,\n                checkboxOnRight ? checkboxNode : null)));\n    }\n});\nexport default TreeNode;\n","import { h, defineComponent } from 'vue';\nimport { pxfy } from 'seemly';\nimport FadeInExpandTransition from '../../_internal/fade-in-expand-transition';\nimport TreeNode from './TreeNode';\nexport default defineComponent({\n    name: 'TreeMotionWrapper',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        height: Number,\n        nodes: {\n            type: Array,\n            required: true\n        },\n        mode: {\n            type: String,\n            required: true\n        },\n        onAfterEnter: {\n            type: Function,\n            required: true\n        }\n    },\n    render() {\n        const { clsPrefix } = this;\n        return (h(FadeInExpandTransition, { onAfterEnter: this.onAfterEnter, appear: true, reverse: this.mode === 'collapse' }, {\n            default: () => (h(\"div\", { class: [\n                    `${clsPrefix}-tree-motion-wrapper`,\n                    `${clsPrefix}-tree-motion-wrapper--${this.mode}`\n                ], style: {\n                    height: pxfy(this.height)\n                } }, this.nodes.map((node) => (h(TreeNode, { clsPrefix: clsPrefix, tmNode: node })))))\n        }));\n    }\n});\n","import { c, cB, cE, cM, cNotM } from '../../../_utils/cssr';\nimport { iconSwitchTransition } from '../../../_styles/transitions/icon-switch.cssr';\nimport { fadeInHeightExpandTransition } from '../../../_styles/transitions/fade-in-height-expand.cssr';\n// vars:\n// --n-arrow-color\n// --n-bezier\n// --n-font-size\n// --n-node-border-radius\n// --n-node-color-active\n// --n-node-color-hover\n// --n-node-color-pressed\n// --n-node-text-color\n// --n-node-text-color-disabled\nexport default cB('tree', `\n font-size: var(--n-font-size);\n outline: none;\n`, [c('ul, li', `\n margin: 0;\n padding: 0;\n list-style: none;\n `), c('>', [cB('tree-node', [c('&:first-child', {\n  marginTop: 0\n})])]), cB('tree-node-indent', `\n flex-grow: 0;\n flex-shrink: 0;\n height: 0;\n `), cB('tree-motion-wrapper', [cM('expand', [fadeInHeightExpandTransition({\n  duration: '0.2s'\n})]), cM('collapse', [fadeInHeightExpandTransition({\n  duration: '0.2s',\n  reverse: true\n})])]), cB('tree-node-wrapper', `\n box-sizing: border-box;\n padding: 3px 0;\n `), cB('tree-node', `\n transform: translate3d(0,0,0);\n position: relative;\n display: flex;\n border-radius: var(--n-node-border-radius);\n transition: background-color .3s var(--n-bezier);\n `, [cM('highlight', [cB('tree-node-content', [cE('text', {\n  borderBottomColor: 'var(--n-node-text-color-disabled)'\n})])]), cM('disabled', [cB('tree-node-content', `\n color: var(--n-node-text-color-disabled);\n cursor: not-allowed;\n `)]), cNotM('disabled', [cM('clickable', [cB('tree-node-content', `\n cursor: pointer;\n `)])])]), cM('block-node', [cB('tree-node-content', `\n flex: 1;\n min-width: 0;\n `)]), cNotM('block-line', [cB('tree-node', [cNotM('disabled', [cB('tree-node-content', [c('&:hover', {\n  backgroundColor: 'var(--n-node-color-hover)'\n})]), cM('selectable', [cB('tree-node-content', [c('&:active', {\n  backgroundColor: 'var(--n-node-color-pressed)'\n})])]), cM('pending', [cB('tree-node-content', `\n background-color: var(--n-node-color-hover);\n `)]), cM('selected', [cB('tree-node-content', {\n  backgroundColor: 'var(--n-node-color-active)'\n})])])])]), cM('block-line', [cB('tree-node', [cNotM('disabled', [c('&:hover', {\n  backgroundColor: 'var(--n-node-color-hover)'\n}), cM('pending', `\n background-color: var(--n-node-color-hover);\n `), cM('selectable', [cNotM('selected', [c('&:active', {\n  backgroundColor: 'var(--n-node-color-pressed)'\n})])]), cM('selected', {\n  backgroundColor: 'var(--n-node-color-active)'\n})]), cM('disabled', `\n cursor: not-allowed;\n `)])]), cB('tree-node-switcher', `\n cursor: pointer;\n display: inline-flex;\n flex-shrink: 0;\n height: 24px;\n width: 24px;\n align-items: center;\n justify-content: center;\n transition: transform .15s var(--n-bezier);\n vertical-align: bottom;\n `, [cE('icon', `\n position: relative;\n height: 14px;\n width: 14px;\n display: flex;\n color: var(--n-arrow-color);\n transition: color .3s var(--n-bezier);\n font-size: 14px;\n `, [cB('icon', [iconSwitchTransition()]), cB('base-loading', `\n color: var(--n-loading-color);\n position: absolute;\n left: 0;\n top: 0;\n right: 0;\n bottom: 0;\n `, [iconSwitchTransition()]), cB('base-icon', [iconSwitchTransition()])]), cM('hide', {\n  visibility: 'hidden'\n}), cM('expanded', {\n  transform: 'rotate(90deg)'\n})]), cB('tree-node-checkbox', `\n display: inline-flex;\n height: 24px;\n width: 16px;\n vertical-align: bottom;\n align-items: center;\n justify-content: center;\n margin-right: 4px;\n `, [cM('right', 'margin-left: 4px;')]), cM('checkable', [cB('tree-node-content', `\n padding: 0 6px;\n `)]), cB('tree-node-content', `\n position: relative;\n display: inline-flex;\n align-items: center;\n min-height: 24px;\n box-sizing: border-box;\n line-height: 1.5;\n vertical-align: bottom;\n padding: 0 6px 0 4px;\n cursor: default;\n border-radius: var(--n-node-border-radius);\n text-decoration-color: #0000;\n text-decoration-line: underline;\n color: var(--n-node-text-color);\n transition:\n color .3s var(--n-bezier),\n text-decoration-color .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n `, [c('&:last-child', {\n  marginBottom: 0\n}), cE('prefix', `\n display: inline-flex;\n margin-right: 8px;\n `), cE('text', `\n border-bottom: 1px solid #0000;\n transition: border-color .3s var(--n-bezier);\n flex-grow: 1;\n max-width: 100%;\n `), cE('suffix', `\n display: inline-flex;\n `)]), cE('empty', 'margin: auto;')]);","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { h, ref, toRef, computed, defineComponent, provide, watch, nextTick, watchEffect, inject } from 'vue';\nimport { createTreeMate, flatten, createIndexGetter } from 'treemate';\nimport { useMergedState } from 'vooks';\nimport { VVirtualList } from 'vueuc';\nimport { getPadding } from 'seemly';\nimport { treeSelectInjectionKey } from '../../tree-select/src/interface';\nimport { useConfig, useTheme, useThemeClass, useRtl } from '../../_mixins';\nimport { call, createDataKey, resolveSlot, warn, warnOnce } from '../../_utils';\nimport { NxScrollbar } from '../../_internal';\nimport { treeLight } from '../styles';\nimport { NEmpty } from '../../empty';\nimport NTreeNode from './TreeNode';\nimport { keysWithFilter, emptyImage, filterTree, isNodeDisabled, useMergedCheckStrategy } from './utils';\nimport { useKeyboard } from './keyboard';\nimport { treeInjectionKey } from './interface';\nimport MotionWrapper from './MotionWrapper';\nimport { defaultAllowDrop } from './dnd';\nimport style from './styles/index.cssr';\n// TODO:\n// During expanding, some node are mis-applied with :active style\n// Async dnd has bug\nconst ITEM_SIZE = 30; // 24 + 3 + 3\nexport function createTreeMateOptions(keyField, childrenField, disabledField, getChildren) {\n    const settledGetChildren = getChildren ||\n        ((node) => {\n            return node[childrenField];\n        });\n    return {\n        getIsGroup() {\n            return false;\n        },\n        getKey(node) {\n            return node[keyField];\n        },\n        getChildren: settledGetChildren,\n        getDisabled(node) {\n            return !!(node[disabledField] || node.checkboxDisabled);\n        }\n    };\n}\nexport const treeSharedProps = {\n    allowCheckingNotLoaded: Boolean,\n    filter: Function,\n    defaultExpandAll: Boolean,\n    expandedKeys: Array,\n    keyField: {\n        type: String,\n        default: 'key'\n    },\n    labelField: {\n        type: String,\n        default: 'label'\n    },\n    childrenField: {\n        type: String,\n        default: 'children'\n    },\n    disabledField: {\n        type: String,\n        default: 'disabled'\n    },\n    defaultExpandedKeys: {\n        type: Array,\n        default: () => []\n    },\n    indeterminateKeys: Array,\n    renderSwitcherIcon: Function,\n    onUpdateIndeterminateKeys: [Function, Array],\n    'onUpdate:indeterminateKeys': [Function, Array],\n    onUpdateExpandedKeys: [Function, Array],\n    'onUpdate:expandedKeys': [Function, Array]\n};\nexport const treeProps = Object.assign(Object.assign(Object.assign(Object.assign({}, useTheme.props), { accordion: Boolean, showIrrelevantNodes: { type: Boolean, default: true }, data: {\n        type: Array,\n        default: () => []\n    }, expandOnDragenter: {\n        type: Boolean,\n        default: true\n    }, expandOnClick: Boolean, checkOnClick: {\n        type: [Boolean, Function],\n        default: false\n    }, cancelable: {\n        type: Boolean,\n        default: true\n    }, checkable: Boolean, draggable: Boolean, blockNode: Boolean, blockLine: Boolean, disabled: Boolean, checkedKeys: Array, defaultCheckedKeys: {\n        type: Array,\n        default: () => []\n    }, selectedKeys: Array, defaultSelectedKeys: {\n        type: Array,\n        default: () => []\n    }, multiple: Boolean, pattern: {\n        type: String,\n        default: ''\n    }, onLoad: Function, cascade: Boolean, selectable: {\n        type: Boolean,\n        default: true\n    }, indent: {\n        type: Number,\n        default: 16\n    }, allowDrop: {\n        type: Function,\n        default: defaultAllowDrop\n    }, animated: {\n        type: Boolean,\n        default: true\n    }, checkboxPlacement: {\n        type: String,\n        default: 'left'\n    }, virtualScroll: Boolean, watchProps: Array, renderLabel: Function, renderPrefix: Function, renderSuffix: Function, nodeProps: Function, keyboard: {\n        type: Boolean,\n        default: true\n    }, getChildren: Function, onDragenter: [Function, Array], onDragleave: [Function, Array], onDragend: [Function, Array], onDragstart: [Function, Array], onDragover: [Function, Array], onDrop: [Function, Array], onUpdateCheckedKeys: [Function, Array], 'onUpdate:checkedKeys': [Function, Array], onUpdateSelectedKeys: [Function, Array], 'onUpdate:selectedKeys': [Function, Array] }), treeSharedProps), { \n    // internal props for tree-select\n    internalTreeSelect: Boolean, internalScrollable: Boolean, internalScrollablePadding: String, \n    // use it to display\n    internalRenderEmpty: Function, internalHighlightKeySet: Object, internalUnifySelectCheck: Boolean, internalCheckboxFocusable: {\n        type: Boolean,\n        default: true\n    }, internalFocusable: {\n        // Make tree-select take over keyboard operations\n        type: Boolean,\n        default: true\n    }, checkStrategy: {\n        type: String,\n        default: 'all'\n    }, \n    /**\n     * @deprecated\n     */\n    leafOnly: Boolean });\nexport default defineComponent({\n    name: 'Tree',\n    props: treeProps,\n    setup(props) {\n        if (process.env.NODE_ENV !== 'production') {\n            watchEffect(() => {\n                if (props.leafOnly) {\n                    warnOnce('tree', '`leaf-only` is deprecated, please use `check-strategy=\"child\"` instead');\n                }\n            });\n        }\n        const { mergedClsPrefixRef, inlineThemeDisabled, mergedRtlRef } = useConfig(props);\n        const rtlEnabledRef = useRtl('Tree', mergedRtlRef, mergedClsPrefixRef);\n        const themeRef = useTheme('Tree', '-tree', style, treeLight, props, mergedClsPrefixRef);\n        const selfElRef = ref(null);\n        const scrollbarInstRef = ref(null);\n        const virtualListInstRef = ref(null);\n        function getScrollContainer() {\n            var _a;\n            return (_a = virtualListInstRef.value) === null || _a === void 0 ? void 0 : _a.listElRef;\n        }\n        function getScrollContent() {\n            var _a;\n            return (_a = virtualListInstRef.value) === null || _a === void 0 ? void 0 : _a.itemsElRef;\n        }\n        const mergedFilterRef = computed(() => {\n            const { filter } = props;\n            if (filter)\n                return filter;\n            const { labelField } = props;\n            return (pattern, node) => {\n                if (!pattern.length)\n                    return true;\n                const label = node[labelField];\n                if (typeof label === 'string') {\n                    return label.toLowerCase().includes(pattern.toLowerCase());\n                }\n                return false;\n            };\n        });\n        const filteredTreeInfoRef = computed(() => {\n            const { pattern } = props;\n            if (!pattern) {\n                return {\n                    filteredTree: props.data,\n                    highlightKeySet: null,\n                    expandedKeys: undefined\n                };\n            }\n            if (!pattern.length || !mergedFilterRef.value) {\n                return {\n                    filteredTree: props.data,\n                    highlightKeySet: null,\n                    expandedKeys: undefined\n                };\n            }\n            return filterTree(props.data, mergedFilterRef.value, pattern, props.keyField, props.childrenField);\n        });\n        // We don't expect data source to change so we just determine it once\n        const displayTreeMateRef = computed(() => createTreeMate(props.showIrrelevantNodes\n            ? props.data\n            : filteredTreeInfoRef.value.filteredTree, createTreeMateOptions(props.keyField, props.childrenField, props.disabledField, props.getChildren)));\n        const treeSelectInjection = inject(treeSelectInjectionKey, null);\n        const dataTreeMateRef = props.internalTreeSelect\n            ? treeSelectInjection.dataTreeMate\n            : displayTreeMateRef;\n        const { watchProps } = props;\n        const uncontrolledCheckedKeysRef = ref([]);\n        if (watchProps === null || watchProps === void 0 ? void 0 : watchProps.includes('defaultCheckedKeys')) {\n            watchEffect(() => {\n                uncontrolledCheckedKeysRef.value = props.defaultCheckedKeys;\n            });\n        }\n        else {\n            uncontrolledCheckedKeysRef.value = props.defaultCheckedKeys;\n        }\n        const controlledCheckedKeysRef = toRef(props, 'checkedKeys');\n        const mergedCheckedKeysRef = useMergedState(controlledCheckedKeysRef, uncontrolledCheckedKeysRef);\n        const checkedStatusRef = computed(() => {\n            const value = dataTreeMateRef.value.getCheckedKeys(mergedCheckedKeysRef.value, {\n                cascade: props.cascade,\n                allowNotLoaded: props.allowCheckingNotLoaded\n            });\n            return value;\n        });\n        const mergedCheckStrategyRef = useMergedCheckStrategy(props);\n        const displayedCheckedKeysRef = computed(() => {\n            return checkedStatusRef.value.checkedKeys;\n        });\n        const displayedIndeterminateKeysRef = computed(() => {\n            const { indeterminateKeys } = props;\n            if (indeterminateKeys !== undefined)\n                return indeterminateKeys;\n            return checkedStatusRef.value.indeterminateKeys;\n        });\n        const uncontrolledSelectedKeysRef = ref([]);\n        if (watchProps === null || watchProps === void 0 ? void 0 : watchProps.includes('defaultSelectedKeys')) {\n            watchEffect(() => {\n                uncontrolledSelectedKeysRef.value = props.defaultSelectedKeys;\n            });\n        }\n        else {\n            uncontrolledSelectedKeysRef.value = props.defaultSelectedKeys;\n        }\n        const controlledSelectedKeysRef = toRef(props, 'selectedKeys');\n        const mergedSelectedKeysRef = useMergedState(controlledSelectedKeysRef, uncontrolledSelectedKeysRef);\n        const uncontrolledExpandedKeysRef = ref([]);\n        const initUncontrolledExpandedKeys = (keys) => {\n            uncontrolledExpandedKeysRef.value = props.defaultExpandAll\n                ? dataTreeMateRef.value.getNonLeafKeys()\n                : keys === undefined\n                    ? props.defaultExpandedKeys\n                    : keys;\n        };\n        if (watchProps === null || watchProps === void 0 ? void 0 : watchProps.includes('defaultExpandedKeys')) {\n            // if watching defaultExpandedKeys, we use access props.defaultExpandedKeys inside initiator\n            watchEffect(() => { initUncontrolledExpandedKeys(undefined); });\n        }\n        else {\n            // We by default watchEffect since if defaultExpandAll is true, we should remain tree expand if data changes\n            watchEffect(() => { initUncontrolledExpandedKeys(props.defaultExpandedKeys); });\n        }\n        const controlledExpandedKeysRef = toRef(props, 'expandedKeys');\n        const mergedExpandedKeysRef = useMergedState(controlledExpandedKeysRef, uncontrolledExpandedKeysRef);\n        const fNodesRef = computed(() => displayTreeMateRef.value.getFlattenedNodes(mergedExpandedKeysRef.value));\n        const { pendingNodeKeyRef, handleKeydown } = useKeyboard({\n            props,\n            mergedSelectedKeysRef,\n            fNodesRef,\n            mergedExpandedKeysRef,\n            handleSelect,\n            handleSwitcherClick\n        });\n        let expandTimerId = null;\n        let nodeKeyToBeExpanded = null;\n        const uncontrolledHighlightKeySetRef = ref(new Set());\n        const controlledHighlightKeySetRef = computed(() => {\n            return (props.internalHighlightKeySet ||\n                filteredTreeInfoRef.value.highlightKeySet);\n        });\n        const mergedHighlightKeySetRef = useMergedState(controlledHighlightKeySetRef, uncontrolledHighlightKeySetRef);\n        const loadingKeysRef = ref(new Set());\n        const expandedNonLoadingKeysRef = computed(() => {\n            return mergedExpandedKeysRef.value.filter((key) => !loadingKeysRef.value.has(key));\n        });\n        let dragStartX = 0;\n        const draggingNodeRef = ref(null);\n        const droppingNodeRef = ref(null);\n        const droppingMouseNodeRef = ref(null);\n        const droppingPositionRef = ref(null);\n        const droppingOffsetLevelRef = ref(0);\n        const droppingNodeParentRef = computed(() => {\n            const { value: droppingNode } = droppingNodeRef;\n            if (!droppingNode)\n                return null;\n            // May avoid overlap between line mark of first child & rect mark of parent\n            // if (droppingNode.isFirstChild && droppingPositionRef.value === 'before') {\n            //   return null\n            // }\n            return droppingNode.parent;\n        });\n        // shallow watch data\n        watch(toRef(props, 'data'), () => {\n            loadingKeysRef.value.clear();\n            pendingNodeKeyRef.value = null;\n            resetDndState();\n        }, {\n            deep: false\n        });\n        let expandAnimationDisabled = false;\n        const disableExpandAnimationForOneTick = () => {\n            expandAnimationDisabled = true;\n            void nextTick(() => {\n                expandAnimationDisabled = false;\n            });\n        };\n        let memoizedExpandedKeys;\n        watch(toRef(props, 'pattern'), (value, oldValue) => {\n            if (props.showIrrelevantNodes) {\n                memoizedExpandedKeys = undefined;\n                if (value) {\n                    const { expandedKeys: expandedKeysAfterChange, highlightKeySet } = keysWithFilter(props.data, props.pattern, props.keyField, props.childrenField, mergedFilterRef.value);\n                    uncontrolledHighlightKeySetRef.value = highlightKeySet;\n                    disableExpandAnimationForOneTick();\n                    doUpdateExpandedKeys(expandedKeysAfterChange, getOptionsByKeys(expandedKeysAfterChange), { node: null, action: 'filter' });\n                }\n                else {\n                    uncontrolledHighlightKeySetRef.value = new Set();\n                }\n            }\n            else {\n                if (!value.length) {\n                    if (memoizedExpandedKeys !== undefined) {\n                        disableExpandAnimationForOneTick();\n                        doUpdateExpandedKeys(memoizedExpandedKeys, getOptionsByKeys(memoizedExpandedKeys), { node: null, action: 'filter' });\n                    }\n                }\n                else {\n                    if (!oldValue.length) {\n                        memoizedExpandedKeys = mergedExpandedKeysRef.value;\n                    }\n                    const { expandedKeys } = filteredTreeInfoRef.value;\n                    if (expandedKeys !== undefined) {\n                        disableExpandAnimationForOneTick();\n                        doUpdateExpandedKeys(expandedKeys, getOptionsByKeys(expandedKeys), {\n                            node: null,\n                            action: 'filter'\n                        });\n                    }\n                }\n            }\n        });\n        function triggerLoading(node) {\n            return __awaiter(this, void 0, void 0, function* () {\n                const { onLoad } = props;\n                if (!onLoad) {\n                    if (process.env.NODE_ENV !== 'production') {\n                        warn('tree', 'There is unloaded node in data but props.onLoad is not specified.');\n                    }\n                    yield Promise.resolve();\n                    return;\n                }\n                const { value: loadingKeys } = loadingKeysRef;\n                if (!loadingKeys.has(node.key)) {\n                    loadingKeys.add(node.key);\n                    try {\n                        const loadResult = yield onLoad(node.rawNode);\n                        if (loadResult === false) {\n                            resetDragExpandState();\n                        }\n                    }\n                    catch (loadError) {\n                        console.error(loadError);\n                        resetDragExpandState();\n                    }\n                    loadingKeys.delete(node.key);\n                }\n            });\n        }\n        watchEffect(() => {\n            var _a;\n            const { value: displayTreeMate } = displayTreeMateRef;\n            if (!displayTreeMate)\n                return;\n            const { getNode } = displayTreeMate;\n            (_a = mergedExpandedKeysRef.value) === null || _a === void 0 ? void 0 : _a.forEach((key) => {\n                const node = getNode(key);\n                if (node && !node.shallowLoaded) {\n                    void triggerLoading(node);\n                }\n            });\n        });\n        // animation in progress\n        const aipRef = ref(false);\n        // animation flattened nodes\n        const afNodesRef = ref([]);\n        // Note: Since the virtual list depends on min height, if there's a node\n        // whose height starts from 0, the virtual list will have a wrong height\n        // during animation. This will seldom cause wired scrollbar status. It is\n        // fixable and need some changes in vueuc, I've no time so I just leave it\n        // here. Maybe the bug won't be fixed during the life time of the project.\n        watch(expandedNonLoadingKeysRef, (value, prevValue) => {\n            if (!props.animated || expandAnimationDisabled) {\n                void nextTick(syncScrollbar);\n                return;\n            }\n            const prevVSet = new Set(prevValue);\n            let addedKey = null;\n            let removedKey = null;\n            for (const expandedKey of value) {\n                if (!prevVSet.has(expandedKey)) {\n                    if (addedKey !== null)\n                        return; // multi expand, not triggered by click\n                    addedKey = expandedKey;\n                }\n            }\n            const currentVSet = new Set(value);\n            for (const expandedKey of prevValue) {\n                if (!currentVSet.has(expandedKey)) {\n                    if (removedKey !== null)\n                        return; // multi collapse, not triggered by click\n                    removedKey = expandedKey;\n                }\n            }\n            if (addedKey === null && removedKey === null) {\n                // 1. multi action, not triggered by click\n                // 2. no action, don't know what happened\n                return;\n            }\n            const { virtualScroll } = props;\n            const viewportHeight = (virtualScroll ? virtualListInstRef.value.listElRef : selfElRef.value).offsetHeight;\n            const viewportItemCount = Math.ceil(viewportHeight / ITEM_SIZE) + 1;\n            // play add animation\n            let baseExpandedKeys;\n            if (addedKey !== null) {\n                baseExpandedKeys = prevValue;\n            }\n            if (removedKey !== null) {\n                if (baseExpandedKeys === undefined) {\n                    baseExpandedKeys = value;\n                }\n                else {\n                    baseExpandedKeys = baseExpandedKeys.filter((key) => key !== removedKey);\n                }\n            }\n            aipRef.value = true;\n            afNodesRef.value =\n                displayTreeMateRef.value.getFlattenedNodes(baseExpandedKeys);\n            if (addedKey !== null) {\n                const expandedNodeIndex = afNodesRef.value.findIndex((node) => node.key === addedKey);\n                if (~expandedNodeIndex) {\n                    const children = // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                     afNodesRef.value[expandedNodeIndex].children;\n                    // sometimes user will pass leaf keys in\n                    if (children) {\n                        const expandedChildren = flatten(children, value);\n                        afNodesRef.value.splice(expandedNodeIndex + 1, 0, {\n                            __motion: true,\n                            mode: 'expand',\n                            height: virtualScroll\n                                ? expandedChildren.length * ITEM_SIZE\n                                : undefined,\n                            nodes: virtualScroll\n                                ? expandedChildren.slice(0, viewportItemCount)\n                                : expandedChildren\n                        });\n                    }\n                }\n            }\n            if (removedKey !== null) {\n                const collapsedNodeIndex = afNodesRef.value.findIndex((node) => node.key === removedKey);\n                if (~collapsedNodeIndex) {\n                    const collapsedNodeChildren = afNodesRef.value[collapsedNodeIndex].children;\n                    // Sometime the whole tree is change, remove a key doesn't mean it is collapsed,\n                    // but maybe children removed\n                    if (!collapsedNodeChildren)\n                        return;\n                    // play remove animation\n                    aipRef.value = true;\n                    const collapsedChildren = flatten(collapsedNodeChildren, value);\n                    afNodesRef.value.splice(collapsedNodeIndex + 1, 0, {\n                        __motion: true,\n                        mode: 'collapse',\n                        height: virtualScroll\n                            ? collapsedChildren.length * ITEM_SIZE\n                            : undefined,\n                        nodes: virtualScroll\n                            ? collapsedChildren.slice(0, viewportItemCount)\n                            : collapsedChildren\n                    });\n                }\n            }\n        });\n        const getFIndexRef = computed(() => {\n            return createIndexGetter(fNodesRef.value);\n        });\n        const mergedFNodesRef = computed(() => {\n            if (aipRef.value)\n                return afNodesRef.value;\n            else\n                return fNodesRef.value;\n        });\n        function syncScrollbar() {\n            const { value: scrollbarInst } = scrollbarInstRef;\n            if (scrollbarInst)\n                scrollbarInst.sync();\n        }\n        function handleAfterEnter() {\n            aipRef.value = false;\n            if (props.virtualScroll) {\n                // If virtual scroll, we won't listen to resize during animation, so\n                // resize callback of virtual list won't be called and as a result\n                // scrollbar won't sync. We need to sync scrollbar manually.\n                void nextTick(syncScrollbar);\n            }\n        }\n        function getOptionsByKeys(keys) {\n            const { getNode } = dataTreeMateRef.value;\n            return keys.map((key) => { var _a; return ((_a = getNode(key)) === null || _a === void 0 ? void 0 : _a.rawNode) || null; });\n        }\n        function doUpdateExpandedKeys(value, option, meta) {\n            const { 'onUpdate:expandedKeys': _onUpdateExpandedKeys, onUpdateExpandedKeys } = props;\n            uncontrolledExpandedKeysRef.value = value;\n            if (_onUpdateExpandedKeys) {\n                call(_onUpdateExpandedKeys, value, option, meta);\n            }\n            if (onUpdateExpandedKeys) {\n                call(onUpdateExpandedKeys, value, option, meta);\n            }\n        }\n        function doUpdateCheckedKeys(value, option, meta) {\n            const { 'onUpdate:checkedKeys': _onUpdateCheckedKeys, onUpdateCheckedKeys } = props;\n            uncontrolledCheckedKeysRef.value = value;\n            if (onUpdateCheckedKeys) {\n                call(onUpdateCheckedKeys, value, option, meta);\n            }\n            if (_onUpdateCheckedKeys) {\n                call(_onUpdateCheckedKeys, value, option, meta);\n            }\n        }\n        function doUpdateIndeterminateKeys(value, option) {\n            const { 'onUpdate:indeterminateKeys': _onUpdateIndeterminateKeys, onUpdateIndeterminateKeys } = props;\n            if (_onUpdateIndeterminateKeys) {\n                call(_onUpdateIndeterminateKeys, value, option);\n            }\n            if (onUpdateIndeterminateKeys) {\n                call(onUpdateIndeterminateKeys, value, option);\n            }\n        }\n        function doUpdateSelectedKeys(value, option, meta) {\n            const { 'onUpdate:selectedKeys': _onUpdateSelectedKeys, onUpdateSelectedKeys } = props;\n            uncontrolledSelectedKeysRef.value = value;\n            if (onUpdateSelectedKeys) {\n                call(onUpdateSelectedKeys, value, option, meta);\n            }\n            if (_onUpdateSelectedKeys) {\n                call(_onUpdateSelectedKeys, value, option, meta);\n            }\n        }\n        // Drag & Drop\n        function doDragEnter(info) {\n            const { onDragenter } = props;\n            if (onDragenter)\n                call(onDragenter, info);\n        }\n        function doDragLeave(info) {\n            const { onDragleave } = props;\n            if (onDragleave)\n                call(onDragleave, info);\n        }\n        function doDragEnd(info) {\n            const { onDragend } = props;\n            if (onDragend)\n                call(onDragend, info);\n        }\n        function doDragStart(info) {\n            const { onDragstart } = props;\n            if (onDragstart)\n                call(onDragstart, info);\n        }\n        function doDragOver(info) {\n            const { onDragover } = props;\n            if (onDragover)\n                call(onDragover, info);\n        }\n        function doDrop(info) {\n            const { onDrop } = props;\n            if (onDrop)\n                call(onDrop, info);\n        }\n        function resetDndState() {\n            resetDragState();\n            resetDropState();\n        }\n        function resetDragState() {\n            draggingNodeRef.value = null;\n        }\n        function resetDropState() {\n            droppingOffsetLevelRef.value = 0;\n            droppingNodeRef.value = null;\n            droppingMouseNodeRef.value = null;\n            droppingPositionRef.value = null;\n            resetDragExpandState();\n        }\n        function resetDragExpandState() {\n            if (expandTimerId) {\n                window.clearTimeout(expandTimerId);\n                expandTimerId = null;\n            }\n            nodeKeyToBeExpanded = null;\n        }\n        function handleCheck(node, checked) {\n            // We don't guard for leaf only since we have done it in view layer\n            if (props.disabled || isNodeDisabled(node, props.disabledField)) {\n                return;\n            }\n            if (props.internalUnifySelectCheck && !props.multiple) {\n                handleSelect(node);\n                return;\n            }\n            const checkedAction = checked ? 'check' : 'uncheck';\n            const { checkedKeys, indeterminateKeys } = dataTreeMateRef.value[checkedAction](node.key, displayedCheckedKeysRef.value, {\n                cascade: props.cascade,\n                checkStrategy: mergedCheckStrategyRef.value,\n                allowNotLoaded: props.allowCheckingNotLoaded\n            });\n            doUpdateCheckedKeys(checkedKeys, getOptionsByKeys(checkedKeys), {\n                node: node.rawNode,\n                action: checkedAction\n            });\n            doUpdateIndeterminateKeys(indeterminateKeys, getOptionsByKeys(indeterminateKeys));\n        }\n        function toggleExpand(node) {\n            if (props.disabled)\n                return;\n            const { key } = node;\n            const { value: mergedExpandedKeys } = mergedExpandedKeysRef;\n            const index = mergedExpandedKeys.findIndex((expandNodeId) => expandNodeId === key);\n            if (~index) {\n                const expandedKeysAfterChange = Array.from(mergedExpandedKeys);\n                expandedKeysAfterChange.splice(index, 1);\n                doUpdateExpandedKeys(expandedKeysAfterChange, getOptionsByKeys(expandedKeysAfterChange), {\n                    node: node.rawNode,\n                    action: 'collapse'\n                });\n            }\n            else {\n                const nodeToBeExpanded = displayTreeMateRef.value.getNode(key);\n                if (!nodeToBeExpanded || nodeToBeExpanded.isLeaf) {\n                    return;\n                }\n                let nextKeys;\n                if (props.accordion) {\n                    const siblingKeySet = new Set(node.siblings.map(({ key }) => key));\n                    nextKeys = mergedExpandedKeys.filter((expandedKey) => {\n                        return !siblingKeySet.has(expandedKey);\n                    });\n                    nextKeys.push(key);\n                }\n                else {\n                    nextKeys = mergedExpandedKeys.concat(key);\n                }\n                doUpdateExpandedKeys(nextKeys, getOptionsByKeys(nextKeys), {\n                    node: node.rawNode,\n                    action: 'expand'\n                });\n            }\n        }\n        function handleSwitcherClick(node) {\n            if (props.disabled || aipRef.value)\n                return;\n            toggleExpand(node);\n        }\n        function handleSelect(node) {\n            if (props.disabled || !props.selectable) {\n                return;\n            }\n            pendingNodeKeyRef.value = node.key;\n            if (props.internalUnifySelectCheck) {\n                const { value: { checkedKeys, indeterminateKeys } } = checkedStatusRef;\n                if (props.multiple) {\n                    handleCheck(node, !(checkedKeys.includes(node.key) ||\n                        indeterminateKeys.includes(node.key)));\n                }\n                else {\n                    doUpdateCheckedKeys([node.key], getOptionsByKeys([node.key]), {\n                        node: node.rawNode,\n                        action: 'check'\n                    });\n                }\n            }\n            if (props.multiple) {\n                const selectedKeys = Array.from(mergedSelectedKeysRef.value);\n                const index = selectedKeys.findIndex((key) => key === node.key);\n                if (~index) {\n                    if (props.cancelable) {\n                        selectedKeys.splice(index, 1);\n                    }\n                }\n                else if (!~index) {\n                    selectedKeys.push(node.key);\n                }\n                doUpdateSelectedKeys(selectedKeys, getOptionsByKeys(selectedKeys), {\n                    node: node.rawNode,\n                    action: ~index ? 'unselect' : 'select'\n                });\n            }\n            else {\n                const selectedKeys = mergedSelectedKeysRef.value;\n                if (selectedKeys.includes(node.key)) {\n                    if (props.cancelable) {\n                        doUpdateSelectedKeys([], [], {\n                            node: node.rawNode,\n                            action: 'unselect'\n                        });\n                    }\n                }\n                else {\n                    doUpdateSelectedKeys([node.key], getOptionsByKeys([node.key]), {\n                        node: node.rawNode,\n                        action: 'select'\n                    });\n                }\n            }\n        }\n        function expandDragEnterNode(node) {\n            if (expandTimerId) {\n                window.clearTimeout(expandTimerId);\n                expandTimerId = null;\n            }\n            // Don't expand leaf node.\n            if (node.isLeaf)\n                return;\n            nodeKeyToBeExpanded = node.key;\n            const expand = () => {\n                if (nodeKeyToBeExpanded !== node.key)\n                    return;\n                const { value: droppingMouseNode } = droppingMouseNodeRef;\n                if (droppingMouseNode &&\n                    droppingMouseNode.key === node.key &&\n                    !mergedExpandedKeysRef.value.includes(node.key)) {\n                    const nextKeys = mergedExpandedKeysRef.value.concat(node.key);\n                    doUpdateExpandedKeys(nextKeys, getOptionsByKeys(nextKeys), {\n                        node: node.rawNode,\n                        action: 'expand'\n                    });\n                }\n                expandTimerId = null;\n                nodeKeyToBeExpanded = null;\n            };\n            if (!node.shallowLoaded) {\n                expandTimerId = window.setTimeout(() => {\n                    void triggerLoading(node).then(() => {\n                        expand();\n                    });\n                }, 1000);\n            }\n            else {\n                expandTimerId = window.setTimeout(() => {\n                    expand();\n                }, 1000);\n            }\n        }\n        // Dnd\n        function handleDragEnter({ event, node }) {\n            // node should be a tmNode\n            if (!props.draggable ||\n                props.disabled ||\n                isNodeDisabled(node, props.disabledField)) {\n                return;\n            }\n            handleDragOver({ event, node }, false);\n            doDragEnter({ event, node: node.rawNode });\n        }\n        function handleDragLeave({ event, node }) {\n            if (!props.draggable ||\n                props.disabled ||\n                isNodeDisabled(node, props.disabledField)) {\n                return;\n            }\n            doDragLeave({ event, node: node.rawNode });\n        }\n        function handleDragLeaveTree(e) {\n            if (e.target !== e.currentTarget)\n                return;\n            resetDropState();\n        }\n        // Dragend is ok, we don't need to add global listener to reset drag status\n        function handleDragEnd({ event, node }) {\n            resetDndState();\n            if (!props.draggable ||\n                props.disabled ||\n                isNodeDisabled(node, props.disabledField)) {\n                return;\n            }\n            doDragEnd({ event, node: node.rawNode });\n        }\n        function handleDragStart({ event, node }) {\n            var _a;\n            if (!props.draggable ||\n                props.disabled ||\n                isNodeDisabled(node, props.disabledField)) {\n                return;\n            }\n            // Most of time, the image will block user's view\n            emptyImage && ((_a = event.dataTransfer) === null || _a === void 0 ? void 0 : _a.setDragImage(emptyImage, 0, 0));\n            dragStartX = event.clientX;\n            draggingNodeRef.value = node;\n            doDragStart({ event, node: node.rawNode });\n        }\n        function handleDragOver({ event, node }, emit = true) {\n            var _a;\n            if (!props.draggable ||\n                props.disabled ||\n                isNodeDisabled(node, props.disabledField)) {\n                return;\n            }\n            const { value: draggingNode } = draggingNodeRef;\n            if (!draggingNode)\n                return;\n            const { allowDrop, indent } = props;\n            if (emit)\n                doDragOver({ event, node: node.rawNode });\n            // Update dropping node\n            const el = event.currentTarget;\n            const { height: elOffsetHeight, top: elClientTop } = el.getBoundingClientRect();\n            const eventOffsetY = event.clientY - elClientTop;\n            let mousePosition;\n            const allowDropInside = allowDrop({\n                node: node.rawNode,\n                dropPosition: 'inside',\n                phase: 'drag'\n            });\n            if (allowDropInside) {\n                if (eventOffsetY <= 8) {\n                    mousePosition = 'before';\n                }\n                else if (eventOffsetY >= elOffsetHeight - 8) {\n                    mousePosition = 'after';\n                }\n                else {\n                    mousePosition = 'inside';\n                }\n            }\n            else {\n                if (eventOffsetY <= elOffsetHeight / 2) {\n                    mousePosition = 'before';\n                }\n                else {\n                    mousePosition = 'after';\n                }\n            }\n            const { value: getFindex } = getFIndexRef;\n            /** determine the drop position and drop node */\n            /** the dropping node needn't to be the mouse hovering node! */\n            /**\n             * if there is something i've learned from implementing a complex\n             * drag & drop. that is never write unit test before you really figure\n             * out what behavior is exactly you want.\n             */\n            let finalDropNode;\n            let finalDropPosition;\n            const hoverNodeFIndex = getFindex(node.key);\n            if (hoverNodeFIndex === null) {\n                resetDropState();\n                return;\n            }\n            let mouseAtExpandedNonLeafNode = false;\n            if (mousePosition === 'inside') {\n                finalDropNode = node;\n                finalDropPosition = 'inside';\n            }\n            else {\n                if (mousePosition === 'before') {\n                    if (node.isFirstChild) {\n                        finalDropNode = node;\n                        finalDropPosition = 'before';\n                    }\n                    else {\n                        finalDropNode = fNodesRef.value[hoverNodeFIndex - 1];\n                        finalDropPosition = 'after';\n                    }\n                }\n                else {\n                    finalDropNode = node;\n                    finalDropPosition = 'after';\n                }\n            }\n            // If the node is non-leaf and it is expanded, we don't allow it to\n            // drop after it and change it to drop before its next view sibling\n            if (!finalDropNode.isLeaf &&\n                mergedExpandedKeysRef.value.includes(finalDropNode.key)) {\n                mouseAtExpandedNonLeafNode = true;\n                if (finalDropPosition === 'after') {\n                    finalDropNode = fNodesRef.value[hoverNodeFIndex + 1];\n                    if (!finalDropNode) {\n                        // maybe there is no next view sibling when non-leaf node has no\n                        // children and it is the last node in the tree\n                        finalDropNode = node;\n                        finalDropPosition = 'inside';\n                    }\n                    else {\n                        finalDropPosition = 'before';\n                    }\n                }\n            }\n            const droppingMouseNode = finalDropNode;\n            droppingMouseNodeRef.value = droppingMouseNode;\n            // This is a speacial case, user is dragging a last child itself, so we\n            // only view it as they are trying to drop after it.\n            // There are some relevant codes in bailout 1's child branch.\n            // Also, the expand bailout should have a high priority. If it's non-leaf\n            // node and expanded, keep its origin drop position\n            if (!mouseAtExpandedNonLeafNode &&\n                draggingNode.isLastChild &&\n                draggingNode.key === finalDropNode.key) {\n                finalDropPosition = 'after';\n            }\n            if (finalDropPosition === 'after') {\n                let offset = dragStartX - event.clientX; // drag left => > 0\n                let offsetLevel = 0;\n                while (offset >= indent / 2 && // divide by 2 to make it easier to trigger\n                    finalDropNode.parent !== null &&\n                    finalDropNode.isLastChild &&\n                    offsetLevel < 1) {\n                    offset -= indent;\n                    offsetLevel += 1;\n                    finalDropNode = finalDropNode.parent;\n                }\n                droppingOffsetLevelRef.value = offsetLevel;\n            }\n            else {\n                droppingOffsetLevelRef.value = 0;\n            }\n            // Bailout 1\n            // Drag self into self\n            // Drag it into direct parent\n            if (draggingNode.contains(finalDropNode) ||\n                (finalDropPosition === 'inside' &&\n                    ((_a = draggingNode.parent) === null || _a === void 0 ? void 0 : _a.key) === finalDropNode.key)) {\n                if (draggingNode.key === droppingMouseNode.key &&\n                    draggingNode.key === finalDropNode.key) {\n                    // This is special case that we want ui to show a mark to guide user\n                    // to start dragging. Nor they will think nothing happens.\n                    // However this is an invalid drop, we need to guard it inside\n                    // handleDrop\n                }\n                else {\n                    resetDropState();\n                    return;\n                }\n            }\n            // Bailout 3\n            if (!allowDrop({\n                node: finalDropNode.rawNode,\n                dropPosition: finalDropPosition,\n                phase: 'drag'\n            })) {\n                resetDropState();\n                return;\n            }\n            if (draggingNode.key === finalDropNode.key) {\n                // don't expand when drag on itself\n                resetDragExpandState();\n            }\n            else {\n                if (nodeKeyToBeExpanded !== finalDropNode.key) {\n                    if (finalDropPosition === 'inside') {\n                        if (props.expandOnDragenter) {\n                            expandDragEnterNode(finalDropNode);\n                            // Bailout 4\n                            // not try to loading\n                            if (!finalDropNode.shallowLoaded &&\n                                nodeKeyToBeExpanded !== finalDropNode.key) {\n                                resetDndState();\n                                return;\n                            }\n                        }\n                        else {\n                            // Bailout 5\n                            // never expands on drag\n                            if (!finalDropNode.shallowLoaded) {\n                                resetDndState();\n                                return;\n                            }\n                        }\n                    }\n                    else {\n                        resetDragExpandState();\n                    }\n                }\n                else {\n                    if (finalDropPosition !== 'inside') {\n                        resetDragExpandState();\n                    }\n                }\n            }\n            droppingPositionRef.value = finalDropPosition;\n            droppingNodeRef.value = finalDropNode;\n        }\n        function handleDrop({ event, node, dropPosition }) {\n            if (!props.draggable ||\n                props.disabled ||\n                isNodeDisabled(node, props.disabledField)) {\n                return;\n            }\n            const { value: draggingNode } = draggingNodeRef;\n            const { value: droppingNode } = droppingNodeRef;\n            const { value: droppingPosition } = droppingPositionRef;\n            if (!draggingNode || !droppingNode || !droppingPosition) {\n                return;\n            }\n            // Bailout 1\n            if (!props.allowDrop({\n                node: droppingNode.rawNode,\n                dropPosition: droppingPosition,\n                phase: 'drag'\n            })) {\n                return;\n            }\n            // Bailout 2\n            // This is a special case to guard since we want ui to show the status\n            // but not to emit a event\n            if (draggingNode.key === droppingNode.key) {\n                return;\n            }\n            // Bailout 3\n            // insert before its next node\n            // insert after its prev node\n            if (droppingPosition === 'before') {\n                const nextNode = draggingNode.getNext({ includeDisabled: true });\n                if (nextNode) {\n                    if (nextNode.key === droppingNode.key) {\n                        resetDropState();\n                        return;\n                    }\n                }\n            }\n            if (droppingPosition === 'after') {\n                const prevNode = draggingNode.getPrev({ includeDisabled: true });\n                if (prevNode) {\n                    if (prevNode.key === droppingNode.key) {\n                        resetDropState();\n                        return;\n                    }\n                }\n            }\n            doDrop({\n                event,\n                node: droppingNode.rawNode,\n                dragNode: draggingNode.rawNode,\n                dropPosition\n            });\n            resetDndState();\n        }\n        function handleScroll() {\n            syncScrollbar();\n        }\n        function handleResize() {\n            syncScrollbar();\n        }\n        function handleFocusout(e) {\n            var _a;\n            if (props.virtualScroll || props.internalScrollable) {\n                const { value: scrollbarInst } = scrollbarInstRef;\n                if ((_a = scrollbarInst === null || scrollbarInst === void 0 ? void 0 : scrollbarInst.containerRef) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget)) {\n                    return;\n                }\n                pendingNodeKeyRef.value = null;\n            }\n            else {\n                const { value: selfEl } = selfElRef;\n                if (selfEl === null || selfEl === void 0 ? void 0 : selfEl.contains(e.relatedTarget))\n                    return;\n                pendingNodeKeyRef.value = null;\n            }\n        }\n        watch(pendingNodeKeyRef, (value) => {\n            var _a, _b;\n            if (value === null)\n                return;\n            if (props.virtualScroll) {\n                (_a = virtualListInstRef.value) === null || _a === void 0 ? void 0 : _a.scrollTo({ key: value });\n            }\n            else if (props.internalScrollable) {\n                const { value: scrollbarInst } = scrollbarInstRef;\n                if (scrollbarInst === null)\n                    return;\n                const targetEl = (_b = scrollbarInst.contentRef) === null || _b === void 0 ? void 0 : _b.querySelector(`[data-key=\"${createDataKey(value)}\"]`);\n                if (!targetEl)\n                    return;\n                scrollbarInst.scrollTo({\n                    el: targetEl\n                });\n            }\n        });\n        provide(treeInjectionKey, {\n            loadingKeysRef,\n            highlightKeySetRef: mergedHighlightKeySetRef,\n            displayedCheckedKeysRef,\n            displayedIndeterminateKeysRef,\n            mergedSelectedKeysRef,\n            mergedExpandedKeysRef,\n            mergedThemeRef: themeRef,\n            mergedCheckStrategyRef,\n            nodePropsRef: toRef(props, 'nodeProps'),\n            disabledRef: toRef(props, 'disabled'),\n            checkableRef: toRef(props, 'checkable'),\n            selectableRef: toRef(props, 'selectable'),\n            expandOnClickRef: toRef(props, 'expandOnClick'),\n            onLoadRef: toRef(props, 'onLoad'),\n            draggableRef: toRef(props, 'draggable'),\n            blockLineRef: toRef(props, 'blockLine'),\n            indentRef: toRef(props, 'indent'),\n            cascadeRef: toRef(props, 'cascade'),\n            checkOnClickRef: toRef(props, 'checkOnClick'),\n            checkboxPlacementRef: props.checkboxPlacement,\n            droppingMouseNodeRef,\n            droppingNodeParentRef,\n            draggingNodeRef,\n            droppingPositionRef,\n            droppingOffsetLevelRef,\n            fNodesRef,\n            pendingNodeKeyRef,\n            disabledFieldRef: toRef(props, 'disabledField'),\n            internalScrollableRef: toRef(props, 'internalScrollable'),\n            internalCheckboxFocusableRef: toRef(props, 'internalCheckboxFocusable'),\n            internalTreeSelect: props.internalTreeSelect,\n            renderLabelRef: toRef(props, 'renderLabel'),\n            renderPrefixRef: toRef(props, 'renderPrefix'),\n            renderSuffixRef: toRef(props, 'renderSuffix'),\n            renderSwitcherIconRef: toRef(props, 'renderSwitcherIcon'),\n            labelFieldRef: toRef(props, 'labelField'),\n            multipleRef: toRef(props, 'multiple'),\n            handleSwitcherClick,\n            handleDragEnd,\n            handleDragEnter,\n            handleDragLeave,\n            handleDragStart,\n            handleDrop,\n            handleDragOver,\n            handleSelect,\n            handleCheck\n        });\n        function scrollTo(options) {\n            var _a;\n            (_a = virtualListInstRef.value) === null || _a === void 0 ? void 0 : _a.scrollTo(options);\n        }\n        const exposedMethods = {\n            handleKeydown,\n            scrollTo,\n            getCheckedData: () => {\n                if (!props.checkable)\n                    return { keys: [], options: [] };\n                const { checkedKeys } = checkedStatusRef.value;\n                return {\n                    keys: checkedKeys,\n                    options: getOptionsByKeys(checkedKeys)\n                };\n            },\n            getIndeterminateData: () => {\n                if (!props.checkable)\n                    return { keys: [], options: [] };\n                const { indeterminateKeys } = checkedStatusRef.value;\n                return {\n                    keys: indeterminateKeys,\n                    options: getOptionsByKeys(indeterminateKeys)\n                };\n            }\n        };\n        const cssVarsRef = computed(() => {\n            const { common: { cubicBezierEaseInOut }, self: { fontSize, nodeBorderRadius, nodeColorHover, nodeColorPressed, nodeColorActive, arrowColor, loadingColor, nodeTextColor, nodeTextColorDisabled, dropMarkColor } } = themeRef.value;\n            return {\n                '--n-arrow-color': arrowColor,\n                '--n-loading-color': loadingColor,\n                '--n-bezier': cubicBezierEaseInOut,\n                '--n-font-size': fontSize,\n                '--n-node-border-radius': nodeBorderRadius,\n                '--n-node-color-active': nodeColorActive,\n                '--n-node-color-hover': nodeColorHover,\n                '--n-node-color-pressed': nodeColorPressed,\n                '--n-node-text-color': nodeTextColor,\n                '--n-node-text-color-disabled': nodeTextColorDisabled,\n                '--n-drop-mark-color': dropMarkColor\n            };\n        });\n        const themeClassHandle = inlineThemeDisabled\n            ? useThemeClass('tree', undefined, cssVarsRef, props)\n            : undefined;\n        return Object.assign(Object.assign({}, exposedMethods), { mergedClsPrefix: mergedClsPrefixRef, mergedTheme: themeRef, rtlEnabled: rtlEnabledRef, fNodes: mergedFNodesRef, aip: aipRef, selfElRef,\n            virtualListInstRef,\n            scrollbarInstRef,\n            handleFocusout,\n            handleDragLeaveTree,\n            handleScroll,\n            getScrollContainer,\n            getScrollContent,\n            handleAfterEnter,\n            handleResize, cssVars: inlineThemeDisabled ? undefined : cssVarsRef, themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass, onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender });\n    },\n    render() {\n        var _a;\n        const { fNodes, internalRenderEmpty } = this;\n        if (!fNodes.length && internalRenderEmpty) {\n            return internalRenderEmpty();\n        }\n        const { mergedClsPrefix, blockNode, blockLine, draggable, disabled, internalFocusable, checkable, handleKeydown, rtlEnabled, handleFocusout } = this;\n        const mergedFocusable = internalFocusable && !disabled;\n        const tabindex = mergedFocusable ? '0' : undefined;\n        const treeClass = [\n            `${mergedClsPrefix}-tree`,\n            rtlEnabled && `${mergedClsPrefix}-tree--rtl`,\n            checkable && `${mergedClsPrefix}-tree--checkable`,\n            (blockLine || blockNode) && `${mergedClsPrefix}-tree--block-node`,\n            blockLine && `${mergedClsPrefix}-tree--block-line`\n        ];\n        const createNode = (tmNode) => {\n            return '__motion' in tmNode ? (h(MotionWrapper, { height: tmNode.height, nodes: tmNode.nodes, clsPrefix: mergedClsPrefix, mode: tmNode.mode, onAfterEnter: this.handleAfterEnter })) : (h(NTreeNode, { key: tmNode.key, tmNode: tmNode, clsPrefix: mergedClsPrefix }));\n        };\n        if (this.virtualScroll) {\n            const { mergedTheme, internalScrollablePadding } = this;\n            const padding = getPadding(internalScrollablePadding || '0');\n            return (h(NxScrollbar, { ref: \"scrollbarInstRef\", onDragleave: draggable ? this.handleDragLeaveTree : undefined, container: this.getScrollContainer, content: this.getScrollContent, class: treeClass, theme: mergedTheme.peers.Scrollbar, themeOverrides: mergedTheme.peerOverrides.Scrollbar, tabindex: tabindex, onKeydown: mergedFocusable ? handleKeydown : undefined, onFocusout: mergedFocusable ? handleFocusout : undefined }, {\n                default: () => {\n                    var _a;\n                    (_a = this.onRender) === null || _a === void 0 ? void 0 : _a.call(this);\n                    return (h(VVirtualList, { ref: \"virtualListInstRef\", items: this.fNodes, itemSize: ITEM_SIZE, ignoreItemResize: this.aip, paddingTop: padding.top, paddingBottom: padding.bottom, class: this.themeClass, style: [\n                            this.cssVars,\n                            {\n                                paddingLeft: padding.left,\n                                paddingRight: padding.right\n                            }\n                        ], onScroll: this.handleScroll, onResize: this.handleResize, showScrollbar: false, itemResizable: true }, {\n                        default: ({ item }) => createNode(item)\n                    }));\n                }\n            }));\n        }\n        const { internalScrollable } = this;\n        treeClass.push(this.themeClass);\n        (_a = this.onRender) === null || _a === void 0 ? void 0 : _a.call(this);\n        if (internalScrollable) {\n            return (h(NxScrollbar, { class: treeClass, tabindex: tabindex, onKeydown: mergedFocusable ? handleKeydown : undefined, onFocusout: mergedFocusable ? handleFocusout : undefined, style: this.cssVars, contentStyle: { padding: this.internalScrollablePadding } }, {\n                default: () => (h(\"div\", { onDragleave: draggable ? this.handleDragLeaveTree : undefined, ref: \"selfElRef\" }, this.fNodes.map(createNode)))\n            }));\n        }\n        else {\n            return (h(\"div\", { class: treeClass, tabindex: tabindex, ref: \"selfElRef\", style: this.cssVars, onKeydown: mergedFocusable ? handleKeydown : undefined, onFocusout: mergedFocusable ? handleFocusout : undefined, onDragleave: draggable ? this.handleDragLeaveTree : undefined }, !fNodes.length\n                ? resolveSlot(this.$slots.empty, () => [\n                    h(NEmpty, { class: `${mergedClsPrefix}-tree__empty`, theme: this.mergedTheme.peers.Empty, themeOverrides: this.mergedTheme.peerOverrides.Empty })\n                ])\n                : fNodes.map(createNode)));\n        }\n    }\n});\n","import { inject, ref } from 'vue';\nimport { treeSelectInjectionKey } from '../../tree-select/src/interface';\nexport function useKeyboard({ props, fNodesRef, mergedExpandedKeysRef, mergedSelectedKeysRef, handleSelect, handleSwitcherClick }) {\n    const { value: mergedSelectedKeys } = mergedSelectedKeysRef;\n    // If it's used in tree-select, make it take over pending state\n    const treeSelectInjection = inject(treeSelectInjectionKey, null);\n    const pendingNodeKeyRef = treeSelectInjection\n        ? treeSelectInjection.pendingNodeKeyRef\n        : ref(mergedSelectedKeys.length\n            ? mergedSelectedKeys[mergedSelectedKeys.length - 1]\n            : null);\n    function handleKeydown(e) {\n        if (!props.keyboard)\n            return;\n        const { value: pendingNodeKey } = pendingNodeKeyRef;\n        if (pendingNodeKey === null) {\n            if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n                e.preventDefault();\n            }\n            if (['ArrowDown', 'ArrowUp', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {\n                if (pendingNodeKey === null) {\n                    const { value: fNodes } = fNodesRef;\n                    let fIndex = 0;\n                    while (fIndex < fNodes.length) {\n                        if (!fNodes[fIndex].disabled) {\n                            pendingNodeKeyRef.value = fNodes[fIndex].key;\n                            break;\n                        }\n                        fIndex += 1;\n                    }\n                }\n            }\n        }\n        else {\n            const { value: fNodes } = fNodesRef;\n            let fIndex = fNodes.findIndex((tmNode) => tmNode.key === pendingNodeKey);\n            if (!~fIndex)\n                return;\n            if (e.key === 'Enter') {\n                handleSelect(fNodes[fIndex]);\n            }\n            else if (e.key === 'ArrowDown') {\n                e.preventDefault();\n                fIndex += 1;\n                while (fIndex < fNodes.length) {\n                    if (!fNodes[fIndex].disabled) {\n                        pendingNodeKeyRef.value = fNodes[fIndex].key;\n                        break;\n                    }\n                    fIndex += 1;\n                }\n            }\n            else if (e.key === 'ArrowUp') {\n                e.preventDefault();\n                fIndex -= 1;\n                while (fIndex >= 0) {\n                    if (!fNodes[fIndex].disabled) {\n                        pendingNodeKeyRef.value = fNodes[fIndex].key;\n                        break;\n                    }\n                    fIndex -= 1;\n                }\n            }\n            else if (e.key === 'ArrowLeft') {\n                const pendingNode = fNodes[fIndex];\n                if (pendingNode.isLeaf ||\n                    !mergedExpandedKeysRef.value.includes(pendingNodeKey)) {\n                    const parentTmNode = pendingNode.getParent();\n                    if (parentTmNode) {\n                        pendingNodeKeyRef.value = parentTmNode.key;\n                    }\n                }\n                else {\n                    handleSwitcherClick(pendingNode);\n                }\n            }\n            else if (e.key === 'ArrowRight') {\n                const pendingNode = fNodes[fIndex];\n                if (pendingNode.isLeaf)\n                    return;\n                if (!mergedExpandedKeysRef.value.includes(pendingNodeKey)) {\n                    handleSwitcherClick(pendingNode);\n                }\n                else {\n                    // Tha same as ArrowDown\n                    fIndex += 1;\n                    while (fIndex < fNodes.length) {\n                        if (!fNodes[fIndex].disabled) {\n                            pendingNodeKeyRef.value = fNodes[fIndex].key;\n                            break;\n                        }\n                        fIndex += 1;\n                    }\n                }\n            }\n        }\n    }\n    return {\n        pendingNodeKeyRef,\n        handleKeydown\n    };\n}\n","import * as Cesium from 'cesium'\nimport type { InjectionKey, Ref } from 'vue'\n\nexport const viewerKey: InjectionKey<Ref<Cesium.Viewer>> = Symbol('mapViewer')\n","import { MapSourceType, MapSourceTypeEnum } from '@/common/map-base'\nimport CesiumSourceLoader from '@/helper/cesium-source-loader'\nimport { useMapStore } from '@/store/map'\n\nimport { viewerKey } from '../types'\nimport styles from './index.module.scss'\nimport SourceModal from './source-modal'\nimport { useResourceTree } from './use-resource-tree'\n\nexport default defineComponent({\n  name: 'ResourceTree',\n  setup() {\n    const mapStore = useMapStore()\n    const resourceModalRef = ref<typeof SourceModal | null>(null)\n    const { stateRef, nodeProps } = useResourceTree()\n\n    const mapViewer = inject(viewerKey)\n    const cesiumSourceLoader = new CesiumSourceLoader(mapViewer!.value)\n    mapStore.saveCesiumSourceLoader(cesiumSourceLoader)\n\n    const handleSelect = (key: string | number) => {\n      if (key === 'ADD') {\n        resourceModalRef.value!.openModal(stateRef.rightObj.key)\n      } else if (key === 'DELETE') {\n        deleteMapSource()\n      } else if (key === 'FLY_TO') {\n        flyToMapSource()\n      }\n\n      stateRef.showDropdown = false\n    }\n\n    const handleClickoutside = () => {\n      stateRef.showDropdown = false\n    }\n\n    /**\n     * 加载地图资源\n     */\n    const loadMapSource = ({\n      type,\n      options\n    }: {\n      type: keyof typeof MapSourceType\n      options: any\n    }) => {\n      // 将资源加载到地图上\n      cesiumSourceLoader.addSource(type, options)\n\n      // 将数据添加到树节点上\n      const parentNode = stateRef.treeData.find((t) => t.key === type)\n      parentNode?.children!.push({\n        label: options.name,\n        key: options.id,\n        isLeaf: true,\n        parentType: type\n      })\n    }\n\n    /**\n     * 删除选中的地图资源\n     */\n    const deleteMapSource = () => {\n      // 删除地图上加载的资源\n      const { key, parentType } = stateRef.rightObj\n      cesiumSourceLoader.deleteSource(key as string, parentType as string)\n\n      // 删除树节点的资源\n      const parentNode = stateRef.treeData.find((t) => t.key === parentType)\n      const index = parentNode?.children!.findIndex((c) => c.key === key)\n      if (!index || index < 0) return\n      parentNode?.children!.splice(index, 1)\n    }\n\n    /**\n     * 飞到选中的底图数据\n     */\n    const flyToMapSource = () => {\n      const { key, parentType } = stateRef.rightObj\n      cesiumSourceLoader.flyTo(key as string, parentType as MapSourceTypeEnum)\n    }\n\n    return () => (\n      <div class={styles.resourceTree}>\n        <NTree\n          data={stateRef.treeData}\n          node-props={nodeProps}\n          checkable\n          expand-on-click\n          default-expand-all\n          selectable\n        />\n        <NDropdown\n          trigger='manual'\n          placement='bottom-start'\n          show={stateRef.showDropdown}\n          options={stateRef.options as any}\n          x={stateRef.x}\n          y={stateRef.y}\n          onSelect={handleSelect}\n          onClickoutside={handleClickoutside}\n        />\n        <SourceModal ref={resourceModalRef} onLoadMapSource={loadMapSource} />\n      </div>\n    )\n  }\n})\n"],"names":["createDataKey","key","SwitcherIcon","defineComponent","name","render","h","xmlns","viewBox","d","CheckMark","class","LineMark","checkboxGroupInjectionKey","createInjectionKey","style$1","c","cB","cE","border","cM","cursor","fill","color","iconSwitchTransition","left","top","display","insideModal","insidePopover","NCheckbox","props","Object","assign","useTheme","size","String","checked","type","Boolean","Number","default","defaultChecked","value","disabled","indeterminate","label","focusable","checkedValue","uncheckedValue","Function","Array","onUpdateChecked","privateInsideTable","onChange","setup","watchEffect","warnOnce","selfRef","ref","mergedClsPrefixRef","inlineThemeDisabled","mergedRtlRef","useConfig","formItem","useFormItem","mergedSize","NFormItem","NCheckboxGroup","mergedSizeRef","mergedDisabled","disabledRef","maxRef","max","checkedCountRef","renderedCheckedRef","minRef","min","mergedDisabledRef","inject","uncontrolledCheckedRef","controlledCheckedRef","toRef","mergedCheckedRef","useMergedState","useMemo","groupValueSet","valueSetRef","has","themeRef","style","checkboxLight","toggle","e","toggleCheckbox","_onUpdateCheck","nTriggerFormInput","nTriggerFormChange","nextChecked","call","exposedMethods","focus","_a","blur","rtlEnabledRef","useRtl","cssVarsRef","computed","common","cubicBezierEaseInOut","self","borderRadius","colorChecked","colorDisabled","colorTableHeader","colorTableHeaderModal","colorTableHeaderPopover","checkMarkColor","checkMarkColorDisabled","borderFocus","borderDisabled","borderChecked","boxShadowFocus","textColor","textColorDisabled","checkMarkColorDisabledChecked","colorDisabledChecked","borderDisabledChecked","labelPadding","labelLineHeight","labelFontWeight","createKey","fontSize","themeClassHandle","useThemeClass","rtlEnabled","mergedClsPrefix","renderedChecked","mergedTheme","labelId","createId","handleClick","handleKeyUp","handleKeyDown","preventDefault","cssVars","themeClass","onRender","$slots","this","tabindex","role","onKeyup","onKeydown","onClick","onMousedown","on","window","once","NIconSwitchTransition","id","treeSelectInjectionKey","treeInjectionKey","NTreeNodeSwitcher","clsPrefix","required","expanded","selected","hide","loading","renderSwitcherIconRef","NBaseLoading","radius","strokeWidth","renderSwitcherIcon","NBaseIcon","NTreeNodeCheckbox","right","onCheck","doCheck","handleUpdateValue","mergedThemeRef","theme","peers","Checkbox","themeOverrides","peerOverrides","NTreeNodeContent","onDragstart","tmNode","nodeProps","renderLabelRef","renderPrefixRef","renderSuffixRef","labelFieldRef","renderLabel","renderPrefix","renderSuffix","labelField","doClick","rawNode","prefix","suffix","draggable","option","renderDropMark","position","offsetLevel","indent","el","boxSizing","bottom","boxShadow","cssPosition","offsetLeft","height","backgroundColor","transformOrigin","transform","isNodeDisabled","node","disabledField","traverse","nodes","childrenField","callback","callbackAfter","forEach","keysWithFilter","pattern","keyField","filter","keys","Set","highlightKeySet","path","push","add","i","length","pop","expandedKeys","from","isBrowser","Image","src","NTreeNode","NTree","droppingNodeParentRef","droppingMouseNodeRef","draggingNodeRef","droppingPositionRef","droppingOffsetLevelRef","nodePropsRef","indentRef","blockLineRef","checkboxPlacementRef","checkOnClickRef","disabledFieldRef","checkboxDisabledRef","checkboxDisabled","nodeIsDisabledRef","resolvedNodePropsRef","contentInstRef","contentElRef","handleSwitcherClick","isLeaf","shallowLoaded","loadingKeysRef","onLoadRef","onLoad","then","finally","delete","onMounted","$el","selectableRef","internalTreeSelect","mergedCheckStrategyRef","multipleRef","cascadeRef","checkableRef","checkedRef","displayedCheckedKeysRef","includes","mergedCheckOnClickRef","checkable","checkOnClick","_handleClick","expandOnClick","expandOnClickRef","selectable","mergedCheckOnClick","happensIn","handleSelect","handleCheck","showDropMark","draggingNode","droppingPosition","droppingMouseNode","showDropMarkAsParent","droppingNodeParent","pending","pendingNodeKeyRef","highlight","highlightKeySetRef","displayedIndeterminateKeysRef","mergedSelectedKeysRef","mergedExpandedKeysRef","internalScrollable","internalScrollableRef","draggableRef","blockLine","checkboxFocusable","internalCheckboxFocusableRef","droppingOffsetLevel","checkboxPlacement","handleDrop","event","dropPosition","handleDragStart","handleDragEnter","currentTarget","target","handleDragOver","handleDragEnd","handleDragLeave","handleLineClick","_b","handleContentClick","dragEventHandlers","onDragenter","onDragleave","onDragend","onDrop","onDragover","dataKey","checkboxOnRight","checkboxNode","repeat","level","width","MotionWrapper","mode","onAfterEnter","FadeInExpandTransition","appear","reverse","pxfy","map","TreeNode","marginTop","fadeInHeightExpandTransition","duration","borderBottomColor","cNotM","visibility","marginBottom","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","apply","treeSharedProps","allowCheckingNotLoaded","defaultExpandAll","defaultExpandedKeys","indeterminateKeys","onUpdateIndeterminateKeys","onUpdateExpandedKeys","__unplugin_components_0","accordion","showIrrelevantNodes","data","expandOnDragenter","cancelable","blockNode","checkedKeys","defaultCheckedKeys","selectedKeys","defaultSelectedKeys","multiple","cascade","allowDrop","children","animated","virtualScroll","watchProps","keyboard","getChildren","onUpdateCheckedKeys","onUpdateSelectedKeys","internalScrollablePadding","internalRenderEmpty","internalHighlightKeySet","internalUnifySelectCheck","internalCheckboxFocusable","internalFocusable","checkStrategy","leafOnly","treeLight","selfElRef","scrollbarInstRef","virtualListInstRef","mergedFilterRef","toLowerCase","filteredTreeInfoRef","tree","visitedTailKeys","visitedNonTailKeys","filteredTree","visit","t","n","build","sibs","isVisitedTail","isVisitedNonTail","clonedNode","filterTree","displayTreeMateRef","createTreeMate","getIsGroup","getKey","getDisabled","treeSelectInjection","dataTreeMateRef","dataTreeMate","uncontrolledCheckedKeysRef","controlledCheckedKeysRef","mergedCheckedKeysRef","checkedStatusRef","getCheckedKeys","allowNotLoaded","useMergedCheckStrategy","uncontrolledSelectedKeysRef","controlledSelectedKeysRef","uncontrolledExpandedKeysRef","initUncontrolledExpandedKeys","getNonLeafKeys","controlledExpandedKeysRef","fNodesRef","getFlattenedNodes","handleKeydown","mergedSelectedKeys","pendingNodeKey","fNodes","fIndex","findIndex","pendingNode","parentTmNode","getParent","useKeyboard","expandTimerId","nodeKeyToBeExpanded","uncontrolledHighlightKeySetRef","controlledHighlightKeySetRef","mergedHighlightKeySetRef","expandedNonLoadingKeysRef","dragStartX","droppingNodeRef","droppingNode","parent","watch","clear","deep","expandAnimationDisabled","disableExpandAnimationForOneTick","nextTick","memoizedExpandedKeys","triggerLoading","warn","loadingKeys","loadError","oldValue","expandedKeysAfterChange","doUpdateExpandedKeys","getOptionsByKeys","action","displayTreeMate","getNode","aipRef","afNodesRef","prevValue","syncScrollbar","prevVSet","addedKey","removedKey","expandedKey","currentVSet","viewportHeight","listElRef","offsetHeight","viewportItemCount","Math","ceil","baseExpandedKeys","expandedNodeIndex","expandedChildren","flatten","splice","__motion","slice","collapsedNodeIndex","collapsedNodeChildren","collapsedChildren","getFIndexRef","createIndexGetter","mergedFNodesRef","scrollbarInst","sync","meta","_onUpdateExpandedKeys","doUpdateCheckedKeys","_onUpdateCheckedKeys","doUpdateSelectedKeys","_onUpdateSelectedKeys","resetDndState","resetDropState","resetDragExpandState","clearTimeout","checkedAction","_onUpdateIndeterminateKeys","doUpdateIndeterminateKeys","mergedExpandedKeys","index","expandNodeId","nodeToBeExpanded","nextKeys","siblingKeySet","siblings","concat","toggleExpand","emit","info","doDragOver","elOffsetHeight","elClientTop","getBoundingClientRect","eventOffsetY","clientY","mousePosition","phase","getFindex","finalDropNode","finalDropPosition","hoverNodeFIndex","mouseAtExpandedNonLeafNode","isFirstChild","isLastChild","offset","clientX","contains","expand","setTimeout","expandDragEnterNode","scrollTo","targetEl","contentRef","querySelector","provide","doDragEnd","doDragEnter","doDragLeave","doDragStart","nextNode","getNext","includeDisabled","prevNode","getPrev","doDrop","dragNode","options","getCheckedData","getIndeterminateData","nodeBorderRadius","nodeColorHover","nodeColorPressed","nodeColorActive","arrowColor","loadingColor","nodeTextColor","nodeTextColorDisabled","dropMarkColor","aip","handleFocusout","containerRef","relatedTarget","selfEl","handleDragLeaveTree","handleScroll","getScrollContainer","getScrollContent","itemsElRef","handleAfterEnter","handleResize","mergedFocusable","treeClass","createNode","padding","getPadding","NxScrollbar","container","content","Scrollbar","onFocusout","VVirtualList","items","itemSize","ignoreItemResize","paddingTop","paddingBottom","paddingLeft","paddingRight","onScroll","onResize","showScrollbar","itemResizable","item","contentStyle","resolveSlot","empty","NEmpty","Empty","viewerKey","Symbol","ResourceTree","mapStore","useMapStore","resourceModalRef","mapViewer","cesiumSourceLoader","parentNode","stateRef","treeData","find","parentType","_createVNode","styles","_resolveComponent","trigger","placement","onSelect"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]}