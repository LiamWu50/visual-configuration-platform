{"version":3,"file":"index-5678333f.js","sources":["../../../src/views/design-space/chart/layers/index.tsx","../../../src/views/design-space/chart/layers/use-context-menu.ts"],"sourcesContent":["import { NDropdown, NInput } from 'naive-ui'\n\nimport imageSrc from '@/assets/images/editor/img.jpg'\nimport { Primitive } from '@/primitives/primitive'\nimport { useEditorStore } from '@/store/editor/index'\n\nimport styles from './index.module.scss'\nimport { useContextMenu } from './use-context-menu'\n\nexport default defineComponent({\n  name: 'Layers',\n  setup() {\n    const xRef = ref(0)\n    const yRef = ref(0)\n    const showDropdownRef = ref(false)\n    const selectedPrimitiveRef = ref<Primitive | null>(null)\n    const editorStore = useEditorStore()\n    const primitives = editorStore.primitives as Primitive[]\n    const { menuOptions, typeHandler, handleProcess } = useContextMenu()\n\n    const handleSelect = (key: string) => {\n      showDropdownRef.value = false\n      handleProcess(\n        selectedPrimitiveRef.value as Primitive,\n        key as keyof typeof typeHandler\n      )\n    }\n\n    const onClickoutside = () => {\n      showDropdownRef.value = false\n    }\n\n    const handleContextMenu = (e: MouseEvent, item: Primitive) => {\n      e.preventDefault()\n      selectedPrimitiveRef.value = item\n      showDropdownRef.value = false\n      nextTick().then(() => {\n        showDropdownRef.value = true\n        xRef.value = e.clientX\n        yRef.value = e.clientY\n      })\n    }\n\n    return {\n      xRef,\n      yRef,\n      showDropdownRef,\n      primitives,\n      menuOptions,\n      handleSelect,\n      onClickoutside,\n      handleContextMenu\n    }\n  },\n  render() {\n    const renderLayerItems = () =>\n      this.primitives.map((item: Primitive) => (\n        <div\n          class={styles.layerItem}\n          onContextmenu={(e) => this.handleContextMenu(e, item)}\n        >\n          <div class={styles.imgCover}>\n            <img src={imageSrc} />\n          </div>\n          {item.isReName ? (\n            <NInput\n              v-model:value={item.name}\n              autofocus={true}\n              onBlur={() => (item.isReName = false)}\n              onKeyup={(e) => e.key === 'Enter' && (item.isReName = false)}\n              type='text'\n              placeholder='请输入组件名称'\n            />\n          ) : (\n            <span>{item.name}</span>\n          )}\n        </div>\n      ))\n\n    return (\n      <div class={styles.layers}>\n        <div class={styles.container}>{renderLayerItems()}</div>\n        <NDropdown\n          placement='bottom-start'\n          trigger='manual'\n          x={this.xRef}\n          y={this.yRef}\n          options={this.menuOptions}\n          show={this.showDropdownRef}\n          onSelect={this.handleSelect}\n          onClickoutside={this.onClickoutside}\n        />\n      </div>\n    )\n  }\n})\n","import { Primitive } from '@/primitives/primitive'\n\nexport function useContextMenu() {\n  const menuOptions = [\n    {\n      label: '重命名',\n      key: 'reName'\n    },\n    {\n      label: '复制',\n      key: ' copy'\n    },\n    {\n      label: '粘贴',\n      key: 'paste'\n    },\n    {\n      label: '删除',\n      key: 'delete'\n    },\n    {\n      label: '锁定',\n      key: 'others1'\n    },\n    {\n      label: '清空剪贴板',\n      key: 'others1'\n    }\n  ]\n\n  const handleReName = (primitive: Primitive) => {\n    primitive.isReName = true\n  }\n\n  const typeHandler = {\n    reName: handleReName\n  }\n\n  const handleProcess = (\n    primitive: Primitive,\n    type: keyof typeof typeHandler\n  ) => {\n    typeHandler[type](primitive)\n  }\n\n  return {\n    menuOptions,\n    typeHandler,\n    handleProcess\n  }\n}\n"],"names":["Layers","defineComponent","name","setup","xRef","ref","yRef","showDropdownRef","selectedPrimitiveRef","primitives","useEditorStore","handleProcess","typeHandler","reName","primitive","isReName","menuOptions","label","key","type","handleContextMenu","e","item","nextTick","render","_createVNode","class","styles","this","map","NInput","$event","autofocus","onBlur","onKeyup","placeholder","renderLayerItems","NDropdown","placement","trigger","onClickoutside"],"mappings":"oxBASA,MAAAA,EAAAC,EAAA,CACEC,KAAAA,SACAC,KAAAA,GACE,MAAAC,EAAAC,EAAA,GACAC,EAAAD,EAAA,GACAE,EAAAF,GAAA,GACAG,EAAAH,EAAA,MAEAI,EADAC,IACAD,sDACkCE,GChB/B,WACL,MA+BMC,EAAc,CAClBC,OALoBC,IACpBA,EAAUC,UAAW,CAAA,GAchB,MAAA,CACLC,YA3CkB,CAClB,CACEC,MAAO,MACPC,IAAK,UAEP,CACED,MAAO,KACPC,IAAK,SAEP,CACED,MAAO,KACPC,IAAK,SAEP,CACED,MAAO,KACPC,IAAK,UAEP,CACED,MAAO,KACPC,IAAK,WAEP,CACED,MAAO,QACPC,IAAK,YAqBPN,cACAD,cAVoB,CACpBG,EACAK,KAEYP,EAAAO,GAAML,EAAS,EAQ/B,kGD5BMH,EAAAA,EAAAA,MAAAA,EAAAA,kCA6BAS,kBAnBF,CAAAC,EAAAC,6CAIEC,IAAAA,MAAAA,gBAEEnB,EAAAA,MAAAA,EAAAA,QACAE,EAAAA,MAAAA,EAAAA,OAAAA,GACF,IAcJkB,MAAAA,GAyBE,OAAAC,EAAA,MAAA,CAAAC,MAAAC,GAC2B,CAAAF,EAAA,MAAA,CAAAC,MAAAC,GACK,CA1BhC,KAAAC,KAAAnB,WAAAoB,KAAAP,GAAAG,EAAA,MAAA,uDAI2D,CAAAA,EAAA,MAAA,CAAAC,MAAAC,GAE1B,CAAAF,EAAA,MAAA,QACP,QAAAH,EAAAP,SAAAU,EAAAK,EAAA,cAIQ,iBAAAC,GAAAT,EAAApB,KAAA6B,EAAAC,WAAA,EACTC,OAAA,IAAAX,EAAAP,UAAA,EACsBmB,QAAAb,GAAA,UAAAA,EAAAH,MAAAI,EAAAP,UAAA,GACuBI,KAAA,OAAAgB,YAAA,WAAA,MAAAV,EAAA,OAAA,KAAA,CAAAH,EAAApB,WAYtCkC,KAAAX,EAAAY,EAAA,CAAqBC,UAAA,eAAAC,QAAA,+GAQpBC,eAAAZ,KAAAY,gBACQ,OAI3C"}